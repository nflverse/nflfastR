<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Changelog • nflfastR</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Changelog" />
<meta property="og:image" content="https://raw.githubusercontent.com/mrcaseb/nflfastR/master/man/figures/card.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content="@nflfastR" />
<meta name="twitter:site" content="@nflfastR" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8FNRBBEHML"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-8FNRBBEHML');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-news">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nflfastR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.2.0.9006</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/nflfastR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/beginners_guide.html">A beginner’s guide to nflfastR</a>
    </li>
    <li>
      <a href="../articles/field_descriptions.html">Field Descriptions</a>
    </li>
    <li>
      <a href="https://www.opensourcefootball.com/posts/2020-09-28-nflfastr-ep-wp-and-cp-models/">nflfastR models</a>
    </li>
    <li>
      <a href="https://www.opensourcefootball.com/">Open Source Football</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/guga31bb/nflfastR-data">
    <span class="fas fa-database fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://rbsdm.com/stats/">
    <span class="fas fa-chart-line fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://nflgamedata.com/">
    <span class="fas fa-football-ball fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://twitter.com/nflfastR">
    <span class="fab fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://discord.gg/5Er2FBnnQa">
    <span class="fab fa-discord fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/mrcaseb/nflfastR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
      <h1 data-toc-skip>Changelog <small></small></h1>
      <small>Source: <a href='https://github.com/mrcaseb/nflfastR/blob/master/NEWS.md'><code>NEWS.md</code></a></small>
    </div>

    <div id="nflfastr-development-version" class="section level1">
<h1 class="page-header" data-toc-text="development version">
<a href="#nflfastr-development-version" class="anchor"></a>nflfastR (development version)<small> Unreleased </small>
</h1>
<ul>
<li>Fix bug where <code>fixed_drive</code> and <code>series</code> weren’t updating after muffed punt (<a href='https://github.com/mrcaseb/nflfastR/issues/144'>#144</a>)</li>
<li>Fixed bug induced by fixing the above (<a href='https://github.com/mrcaseb/nflfastR/issues/149'>#149</a>)</li>
<li>Fix bug where some special teams plays were incorrectly being labeled as pass plays (<a href='https://github.com/mrcaseb/nflfastR/issues/125'>#125</a>)</li>
<li>Fix bug where points for safeties were given to the <code>defteam</code> instead of the <code>posteam</code> (<a href='https://github.com/mrcaseb/nflfastR/issues/152'>#152</a>)</li>
<li>Fix bug where a muffed punt TD was given to the wrong team in a 2011 Jaguars game (<a href='https://github.com/mrcaseb/nflfastR/issues/154'>#154</a>)</li>
<li>Win probability is now calculated prior to PAT attempts rather than using WP on the ensuing kickoff</li>
<li>Added field descriptions dataframe and article</li>
<li>Tuned spread-adjusted win probability model one final (?) time. Expected points is now no longer required for <code><a href="../reference/calculate_win_probability.html">calculate_win_probability()</a></code>
</li>
</ul>
</div>
    <div id="nflfastr-320" class="section level1">
<h1 class="page-header" data-toc-text="3.2.0">
<a href="#nflfastr-320" class="anchor"></a>nflfastR 3.2.0<small> 2020-11-20 </small>
</h1>
<div id="models" class="section level2">
<h2 class="hasAnchor">
<a href="#models" class="anchor"></a>Models</h2>
<ul>
<li>Performance update for win probability model with point spread (<code>vegas_wp</code>)</li>
<li>Added <code>yardline_100</code> as an input to both win probability models (not having it included was an oversight)</li>
</ul>
</div>
<div id="minor-improvements-and-fixes" class="section level2">
<h2 class="hasAnchor">
<a href="#minor-improvements-and-fixes" class="anchor"></a>Minor improvements and fixes</h2>
<ul>
<li>Fixed a bug where <code>series</code> was increased on PATs</li>
<li>Fixed a bug affecting the week 10 Raiders-Broncos game</li>
<li>Added the column <code>team_wordmark</code> - which contains URLs to the team’s wordmarks - to the included data frame <code><a href="../reference/teams_colors_logos.html">?teams_colors_logos</a></code>
</li>
</ul>
</div>
</div>
    <div id="nflfastr-311" class="section level1">
<h1 class="page-header" data-toc-text="3.1.1">
<a href="#nflfastr-311" class="anchor"></a>nflfastR 3.1.1<small> 2020-10-22 </small>
</h1>
<div id="new-features" class="section level2">
<h2 class="hasAnchor">
<a href="#new-features" class="anchor"></a>New features</h2>
<div id="database-function-update_db" class="section level3">
<h3 class="hasAnchor">
<a href="#database-function-update_db" class="anchor"></a>Database Function <code>update_db()</code>
</h3>
<ul>
<li>The argument <code>force_rebuild</code> of the function <code><a href="../reference/update_db.html">update_db()</a></code> is now of hybrid type. It can rebuild the play by play data table either for the whole nflfastR era (with <code>force_rebuild = TRUE</code>) or just for specified seasons (e.g. <code>force_rebuild = 2019:2020</code>). The latter is intended to be used for running seasons because the NFL fixes bugs in the play by play data during the week and we recommend to rebuild the current season every Thursday.</li>
<li>Fixed a bug where <code><a href="../reference/update_db.html">update_db()</a></code> disconnected the connection to a database provided by the argument <code>db_connection</code> (<a href='https://github.com/mrcaseb/nflfastR/issues/102'>#102</a>)</li>
<li>Fixed a bug where <code><a href="../reference/update_db.html">update_db()</a></code> didn’t build a fresh database without providing the argument <code>force_rebuild</code>
</li>
<li>
<code><a href="../reference/update_db.html">update_db()</a></code> no longer removes the complete data table when a numeric argument <code>force_rebuild</code> is passed but only removes the rows within the table (<a href='https://github.com/mrcaseb/nflfastR/issues/109'>#109</a>)</li>
</ul>
</div>
<div id="new-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#new-functions" class="anchor"></a>New Functions</h3>
<ul>
<li>Added the new function <code><a href="../reference/build_nflfastR_pbp.html">build_nflfastR_pbp()</a></code>, a convenient wrapper around multiple nflfastR functions for an easy creation of the nflfastR play-by-play data set</li>
<li>Added a function that applies our experimental expected pass model, <code><a href="../reference/add_xpass.html">add_xpass()</a></code>, that creates columns <code>xpass</code> and <code>pass_oe</code>
</li>
</ul>
</div>
</div>
<div id="minor-improvements-and-fixes-1" class="section level2">
<h2 class="hasAnchor">
<a href="#minor-improvements-and-fixes-1" class="anchor"></a>Minor improvements and fixes</h2>
<ul>
<li>More fixes for <code>fixed_drive</code> which was not incrementing properly on drives that began following a timeout</li>
<li>Fixed more bugs in EPA and win probability on PATs and kickoffs with penalties</li>
<li>Fixed a bug where scoring probabilities weren’t adding to 1 on field goal attempts near the end of a half</li>
<li>Messages to the user are now created with the new dependency <code>usethis</code>
</li>
<li>Fixed bug where plays with “backward pass” in play description were counted as pass plays (<code>pass</code> = 1)</li>
<li>Fixed missing kick distance on touchbacks and blocked punts (<a href='https://github.com/mrcaseb/nflfastR/issues/53'>#53</a>)</li>
<li>Added the option <code>fast</code> (either <code>TRUE</code> or <code>FALSE</code>) to the function <code><a href="../reference/decode_player_ids.html">decode_player_ids()</a></code> to activate the high efficient C++ decoder of the package <a href="https://cran.r-project.org/package=gsisdecoder"><code>gsisdecoder</code></a>
</li>
</ul>
</div>
</div>
    <div id="nflfastr-300" class="section level1">
<h1 class="page-header" data-toc-text="3.0.0">
<a href="#nflfastr-300" class="anchor"></a>nflfastR 3.0.0<small> 2020-09-24 </small>
</h1>
<div id="breaking-changes" class="section level2">
<h2 class="hasAnchor">
<a href="#breaking-changes" class="anchor"></a>Breaking changes</h2>
<ul>
<li>
<code><a href="../reference/fast_scraper_roster.html">fast_scraper_roster()</a></code> is finally back! It loads NFL roster of a given season.</li>
<li>Added the function <code><a href="../reference/decode_player_ids.html">decode_player_ids()</a></code> to decode all player IDs to the commonly known GSIS ID format (00-00xxxxx)</li>
</ul>
</div>
<div id="new-features-1" class="section level2">
<h2 class="hasAnchor">
<a href="#new-features-1" class="anchor"></a>New features</h2>
<ul>
<li>Add option <code>source = "old"</code> to <code><a href="../reference/fast_scraper.html">fast_scraper()</a></code> to enable scraping of old source. This is mostly useless as it doesn’t work for 2020 and provides less info</li>
<li>Added new option <code>db_connection</code> to <code><a href="../reference/update_db.html">update_db()</a></code> to allow advanced users to use other DBI drivers, such as <code>RMariaDB::MariaDB()</code>, <code>RPostgres::Postgres()</code> or <code>odbc::odbc()</code> (please see <a href="https://dbplyr.tidyverse.org/articles/dbplyr.html">dbplyr</a> for more information)</li>
</ul>
</div>
<div id="minor-improvements-and-fixes-2" class="section level2">
<h2 class="hasAnchor">
<a href="#minor-improvements-and-fixes-2" class="anchor"></a>Minor improvements and fixes</h2>
<ul>
<li>
<code><a href="../reference/clean_pbp.html">clean_pbp()</a></code> now fixes some bugs in jersey numbers</li>
<li>
<code><a href="../reference/clean_pbp.html">clean_pbp()</a></code>, <code><a href="../reference/add_qb_epa.html">add_qb_epa()</a></code> and <code><a href="../reference/add_xyac.html">add_xyac()</a></code> can now handle empty data frames</li>
<li>Fix empty line causing <code><a href="../reference/fast_scraper.html">fast_scraper()</a></code> to fail (affects multiple games of the 2020 season)</li>
<li>Fix bug in <code>fixed_drive</code> that counted PAT after defensive TD as its own drive</li>
<li>Fixed a bug which caused too high number of tackles in special cases</li>
<li>Fixed a bug where CPOE was NA when targeting players with apostrophe in last name</li>
</ul>
</div>
</div>
    <div id="nflfastr-221" class="section level1">
<h1 class="page-header" data-toc-text="2.2.1">
<a href="#nflfastr-221" class="anchor"></a>nflfastR 2.2.1<small> 2020-09-01 </small>
</h1>
<ul>
<li>Fix <code><a href="../reference/add_xyac.html">add_xyac()</a></code> breaking with some old packages</li>
<li>Fix <code><a href="../reference/add_xyac.html">add_xyac()</a></code> and <code><a href="../reference/add_qb_epa.html">add_qb_epa()</a></code> calculations being wrong for some failed 4th downs</li>
<li>Updated Readme with ep and cp model plots</li>
<li>Updated <code>vignette("examples")</code> with the new <code><a href="../reference/add_xyac.html">add_xyac()</a></code> function</li>
<li>Added xYAC model to <code>vignette("nflfastR-models")</code>
</li>
<li>Added variables <code>fixed_drive</code> and <code>fixed_drive_result</code> to the output of <code><a href="../reference/fast_scraper.html">fast_scraper()</a></code> because the NFL-provided drive info is extremely buggy</li>
<li>Added variable <code>series_result</code>
</li>
<li>
<code><a href="../reference/clean_pbp.html">clean_pbp()</a></code> now adds 4 new variables <code>passer_jersey_number</code>, <code>rusher_jersey_number</code>, <code>receiver_jersey_number</code> and <code>jersey_number</code>. These can be used to join rosters.</li>
<li>Fixed incorrect <code>timeout_team</code>, <code>return_team</code>, <code>fumble_recovery_1_team</code> for JAX games from 2011-2015</li>
<li>Re-trained EPA model with <code>fixed_drive</code> and corrections to <code>timeout_team</code>
</li>
</ul>
</div>
    <div id="nflfastr-220" class="section level1">
<h1 class="page-header" data-toc-text="2.2.0">
<a href="#nflfastr-220" class="anchor"></a>nflfastR 2.2.0<small> Unreleased </small>
</h1>
<ul>
<li>New function <code><a href="../reference/add_xyac.html">add_xyac()</a></code> which adds the following columns associated with expected yards after the catch (xYAC): <code>xyac_epa</code>, <code>xyac_success</code>, <code>xyac_fd</code>, <code>xyac_mean_yardage</code>, <code>xyac_median_yardage</code>
</li>
</ul>
</div>
    <div id="nflfastr-213" class="section level1">
<h1 class="page-header" data-toc-text="2.1.3">
<a href="#nflfastr-213" class="anchor"></a>nflfastR 2.1.3<small> Unreleased </small>
</h1>
<ul>
<li>Fixed a bug in <code>series_success</code> caused by bad <code>drive</code> information provided by NFL</li>
</ul>
</div>
    <div id="nflfastr-212" class="section level1">
<h1 class="page-header" data-toc-text="2.1.2">
<a href="#nflfastr-212" class="anchor"></a>nflfastR 2.1.2<small> Unreleased </small>
</h1>
<ul>
<li>Added the following columns that are available 2011 and later: <code>special_teams_play</code>, <code>st_play_type</code>, <code>time_of_day</code>, and <code>order_sequence</code>
</li>
<li>Added <code>old_game_id</code> column (useful for merging to external data that still uses this ID: format is YYYYMMDDxx)</li>
<li>The <code><a href="../reference/clean_pbp.html">clean_pbp()</a></code> function now adds an <code>aborted_play</code> column</li>
<li>Fixed a bug where pass plays with a penalty at end of play were classified as <code>play_type</code> = <code>no_play</code> rather than <code>pass</code>
</li>
<li>Fixed bug where EPA on defensive 2 point return was -0.95 instead of -2.95</li>
<li>Fixed some remaining failed challenge plays that incorrectly had 0 for EPA</li>
<li>Updated the included dataframe <code>teams_colors_logos</code> for the interim name of the ‘Washington Football Team’ and the corresponding logo urls.</li>
<li>Some internal code improvements causing the required <code>tidyselect</code> version to be &gt;= 1.1.0</li>
</ul>
</div>
    <div id="nflfastr-211" class="section level1">
<h1 class="page-header" data-toc-text="2.1.1">
<a href="#nflfastr-211" class="anchor"></a>nflfastR 2.1.1<small> Unreleased </small>
</h1>
<div id="functions" class="section level3">
<h3 class="hasAnchor">
<a href="#functions" class="anchor"></a>Functions</h3>
<ul>
<li>
<code><a href="../reference/clean_pbp.html">clean_pbp()</a></code> now standardizes player IDs across the old (1999-2010) and new (2011+) data sources. Player IDs once again uniquely identify players, and each unique player has one unique ID (as they did before the NFL data source change):
<ul>
<li>For players whose careers finished before 2011, their IDs remain the same</li>
<li>For players who played in both eras or only in the new era, their ID is the new ID</li>
<li>For example, Akili Smith (ID: 00-0015082) and Alex Smith (ID: 32013030-2d30-3032-3334-3336b638d37d) are both abbreviated as “A.Smith” but can be distinguished by their IDs, with Akili showing what the old format ID looks like, and Smith the new one</li>
<li>Standardization is realized by using an <a href="https://github.com/guga31bb/nflfastR-data/blob/master/roster-data/legacy_id_map.csv">ID map</a> available in the data repo created with <a href="https://github.com/guga31bb/nflfastR-data/blob/master/roster-data/legacy_id_map.R">this script</a>
</li>
</ul>
</li>
<li>
<code><a href="../reference/clean_pbp.html">clean_pbp()</a></code> now removes all variables it is about to create to make sure nothing unexpected can happen</li>
</ul>
</div>
<div id="miscellaneous" class="section level3">
<h3 class="hasAnchor">
<a href="#miscellaneous" class="anchor"></a>Miscellaneous</h3>
<ul>
<li><p>Added minimum version requirements to some package dependencies because installation broke for some users with outdated packages</p></li>
<li><p>Made a minor bug fix to catch more out-of-order plays and fixed a bug where some plays were being incorrectly dropped in older seasons</p></li>
<li><p>Standardized team names (e.g. <code>SD</code> –&gt; <code>LAC</code>) in some columns we had missed</p></li>
</ul>
</div>
</div>
    <div id="nflfastr-210" class="section level1">
<h1 class="page-header" data-toc-text="2.1.0">
<a href="#nflfastr-210" class="anchor"></a>nflfastR 2.1.0<small> Unreleased </small>
</h1>
<div id="models-1" class="section level3">
<h3 class="hasAnchor">
<a href="#models-1" class="anchor"></a>Models</h3>
<ul>
<li>Removed <code>week</code> from Expected Points models along with an update of <code>vignette("nflfastR-models")</code> and <code>vignette("examples")</code>
</li>
</ul>
</div>
<div id="functions-1" class="section level3">
<h3 class="hasAnchor">
<a href="#functions-1" class="anchor"></a>Functions</h3>
<ul>
<li>Added function <code><a href="../reference/update_db.html">update_db()</a></code> which adds all completed games to a SQLite database</li>
<li>Added function <code><a href="../reference/calculate_win_probability.html">calculate_win_probability()</a></code>
</li>
<li>Added new examples to <code>vignette("examples")</code> demonstrating the usage of the above mentioned functions</li>
</ul>
</div>
<div id="bugs" class="section level3">
<h3 class="hasAnchor">
<a href="#bugs" class="anchor"></a>Bugs</h3>
<ul>
<li>Fixed a problem with inconsistent data types of the variable <code>drive_real_start_time</code> pre and post 2011</li>
<li>Fixed a problem where some <code>game_id</code>s were overwritten during the play by play parsing</li>
<li>Fix some more WP bugs on kickoffs with penalties and rare play description</li>
</ul>
</div>
<div id="miscellaneous-1" class="section level3">
<h3 class="hasAnchor">
<a href="#miscellaneous-1" class="anchor"></a>Miscellaneous</h3>
<ul>
<li>
<code><a href="../reference/fast_scraper.html">fast_scraper()</a></code> now loads the raw game data from a separate raw data repo</li>
<li>Completely overhauled the entire code base to directly implement <a href="https://dplyr.tidyverse.org/articles/programming.html">tidy evaluation</a> using <code>.data</code> from the <a href="https://rlang.r-lib.org/">rlang</a> package (this is a major code change that takes some getting used to but we need it in preparation of a future release)</li>
</ul>
</div>
</div>
    <div id="nflfastr-206" class="section level1">
<h1 class="page-header" data-toc-text="2.0.6">
<a href="#nflfastr-206" class="anchor"></a>nflfastR 2.0.6<small> Unreleased </small>
</h1>
<ul>
<li>Fixed a problem where defensive two point conversions were not counted</li>
<li>Kneels on kickoffs are no longer counted as qb kneels</li>
<li>Variable <code>yards_gained</code> more precisely defined</li>
<li>Bugfixes for more games with out of order of plays</li>
<li>Fix bug related to EPA on plays with a failed pass interference challenge</li>
<li>Added new example to <code>vignette("examples")</code> to demonstrate Expected Points calculator <code><a href="../reference/calculate_expected_points.html">calculate_expected_points()</a></code>
</li>
<li>Fix for WP on 2-pt conversion negated by penalty</li>
<li>Add more variables (containing team names) to team standardization in <code><a href="../reference/clean_pbp.html">clean_pbp()</a></code>
</li>
<li>Fix WP for onside kicks</li>
</ul>
</div>
    <div id="nflfastr-205" class="section level1">
<h1 class="page-header" data-toc-text="2.0.5">
<a href="#nflfastr-205" class="anchor"></a>nflfastR 2.0.5<small> Unreleased </small>
</h1>
<ul>
<li>Fix yet another bug caused by NFL providing plays out of order</li>
<li>Fix bugs related to penalties on PATs and kickoffs</li>
<li>Fix bugs related to NFL providing wrong scoring team on defensive touchdowns in older games involving the Jaguars</li>
<li>Fix some minor issues related to wrong <code>first_down_rush</code> and <code>return_touchdown</code>
</li>
<li>Improved error handling of <code><a href="../reference/fast_scraper.html">fast_scraper()</a></code> for not yet played games</li>
<li>Improved variable documentation and prepared for new website</li>
<li>Improved performance for dplyr v1.0.0</li>
<li>Rebuilt EP and WP models due to bugfixes in the underlying data in the versions 2.0.3, 2.0.4 and 2.0.5</li>
</ul>
</div>
    <div id="nflfastr-204" class="section level1">
<h1 class="page-header" data-toc-text="2.0.4">
<a href="#nflfastr-204" class="anchor"></a>nflfastR 2.0.4<small> Unreleased </small>
</h1>
<ul>
<li>Fix another bug with out of order plays</li>
<li>Fix bug affecting cumulative totals for WPA, air_WPA and yac_WPA</li>
<li>Fix bug affecting cumulative totals for air_EPA and yac_EPA</li>
</ul>
</div>
    <div id="nflfastr-203" class="section level1">
<h1 class="page-header" data-toc-text="2.0.3">
<a href="#nflfastr-203" class="anchor"></a>nflfastR 2.0.3<small> Unreleased </small>
</h1>
<ul>
<li>Fix for NFL providing plays out of order</li>
<li>Fix for series not incrementing following defensive TD</li>
</ul>
</div>
    <div id="nflfastr-202" class="section level1">
<h1 class="page-header" data-toc-text="2.0.2">
<a href="#nflfastr-202" class="anchor"></a>nflfastR 2.0.2<small> Unreleased </small>
</h1>
<ul>
<li>Fixed a bug in the series and series success calculations caused by timeouts following a possession change</li>
<li>Fixed win probability on PATs</li>
</ul>
</div>
    <div id="nflfastr-201" class="section level1">
<h1 class="page-header" data-toc-text="2.0.1">
<a href="#nflfastr-201" class="anchor"></a>nflfastR 2.0.1<small> Unreleased </small>
</h1>
<ul>
<li>Added minimum version requirement on <code>xgboost</code> (&gt;= 1.1) as the recent <code>xgboost</code> update caused a breaking change leading to failure in adding model results to data</li>
</ul>
</div>
    <div id="nflfastr-200" class="section level1">
<h1 class="page-header" data-toc-text="2.0.0">
<a href="#nflfastr-200" class="anchor"></a>nflfastR 2.0.0<small> Unreleased </small>
</h1>
<div id="models-2" class="section level3">
<h3 class="hasAnchor">
<a href="#models-2" class="anchor"></a>Models</h3>
<ul>
<li><p>Added new models for Expected Points, Win Probability and Completion Probability and removed <code>nflscrapR</code> dependency. This is a <strong>major</strong> change as we are stepping away from the well established <code>nflscrapR</code> models. But we believe it is a good step forward. See <code>data-raw/MODEL-README.md</code> for detailed model information.</p></li>
<li><p>Added internal functions for <code>EPA</code> and <code>WPA</code> to <code>helper_add_ep_wp.R</code>.</p></li>
<li><p>Added new function <code><a href="../reference/calculate_expected_points.html">calculate_expected_points()</a></code> usable for the enduser.</p></li>
</ul>
</div>
<div id="functions-2" class="section level3">
<h3 class="hasAnchor">
<a href="#functions-2" class="anchor"></a>Functions</h3>
<ul>
<li><p>Completely overhauled <code><a href="../reference/fast_scraper.html">fast_scraper()</a></code> to make it work with the NFL’s new server backend. The option <code>source</code> is still available but will be deprecated since there is only one source now. There are some changes in the output as well (please see below).</p></li>
<li><p><code><a href="../reference/fast_scraper.html">fast_scraper()</a></code> now adds game data to the play by play data set courtesy of Lee Sharpe. Game data include: away_score, home_score, location, result, total, spread_line, total_line, div_game, roof, surface, temp, wind, home_coach, away_coach, stadium, stadium_id, gameday</p></li>
<li><p><code>fastcraper_schedules()</code> now incorporates Lee Sharpe’s <code>games.rds</code>.</p></li>
<li><p>The functions <code>fast_scraper_clips()</code> and <code><a href="../reference/fast_scraper_roster.html">fast_scraper_roster()</a></code> are deactivated due to the missing data source. They might be reactivated or completely dropped in future versions.</p></li>
<li><p>The function <code>fix_fumbles()</code> has been renamed to <code><a href="../reference/add_qb_epa.html">add_qb_epa()</a></code> as the new name much better describes what the function is actually doing.</p></li>
</ul>
</div>
<div id="miscellaneous-2" class="section level3">
<h3 class="hasAnchor">
<a href="#miscellaneous-2" class="anchor"></a>Miscellaneous</h3>
<ul>
<li><p>Added progress information using the <code>progressr</code>package and removed the <code>furrr</code> progress bars.</p></li>
<li><p><code><a href="../reference/clean_pbp.html">clean_pbp()</a></code> now adds the column <code>ìd</code> which is the id of the player in the column <code>name</code>. Because we have to piece together different data to cover the full span of years, <strong>player IDs are not consistent between the early (1999-2010) and recent (2011 onward) periods</strong>.</p></li>
<li><p>Added a <code>NEWS.md</code> file to track changes to the package.</p></li>
<li><p>Fixed several bugs inhereted from <code>nflscrapR</code>, including one where EPA was missing when a play was followed by two timeouts (for example, a two-minute warning followed by a timeout), and another where <code>play_type</code> was incorrect on plays with declined penalties.</p></li>
<li><p>Fixed a bug, where <code>receiver_player_name</code> and <code>receiver</code> didn’t name the correct players on plays with lateral passes.</p></li>
</ul>
</div>
<div id="play-by-play-output" class="section level3">
<h3 class="hasAnchor">
<a href="#play-by-play-output" class="anchor"></a>Play-by-Play Output</h3>
<p>The output has changed a little bit.</p>
<div id="the-following-variables-were-dropped" class="section level4">
<h4 class="hasAnchor">
<a href="#the-following-variables-were-dropped" class="anchor"></a>The following variables were dropped</h4>
<table>
<colgroup>
<col width="13%">
<col width="86%">
</colgroup>
<thead><tr class="header">
<th>Dropped Variables</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>game_key</td>
<td>RS feed game identifier.</td>
</tr>
<tr class="even">
<td>game_time_local</td>
<td>Kickoff time in local time zone.</td>
</tr>
<tr class="odd">
<td>iso_time</td>
<td>Kickoff time according ISO 8601.</td>
</tr>
<tr class="even">
<td>game_type</td>
<td>One of ‘REG’, ‘WC’, ‘DIV’, ‘CON’, ‘SB’ indicating if a game was a regular season game or one of the playoff rounds.</td>
</tr>
<tr class="odd">
<td>site_id</td>
<td>RS feed id for game site.</td>
</tr>
<tr class="even">
<td>site_city</td>
<td>Game site city.</td>
</tr>
<tr class="odd">
<td>site_state</td>
<td>Game site state.</td>
</tr>
<tr class="even">
<td>drive_possession_team_abbr</td>
<td>Abbreviation of the possession team in a given drive.</td>
</tr>
<tr class="odd">
<td>scoring_team_abbr</td>
<td>Abbreviation of the scoring team if the play was a scoring play.</td>
</tr>
<tr class="even">
<td>scoring_type</td>
<td>String indicating the scoring type. One of ‘FG’, ‘TD’, ‘PAT’, ‘SFTY’, ‘PAT2’.</td>
</tr>
<tr class="odd">
<td>alert_play_type</td>
<td>String describing the play type of a play the NFL has listed as alert play. For most of those plays there are highlight clips available through fast_scraper_clips.</td>
</tr>
<tr class="even">
<td>time_of_day</td>
<td>Local time at the beginning of the play.</td>
</tr>
<tr class="odd">
<td>yards</td>
<td>Analogue yards_gained but with the kicking team being the possession team (which means that there are many yards gained through kickoffs and punts).</td>
</tr>
<tr class="even">
<td>end_yardline_number</td>
<td>Yardline number within the above given side at the end of the given play.</td>
</tr>
<tr class="odd">
<td>end_yardline_side</td>
<td>String indicating the side of the field at the end of the given play.</td>
</tr>
</tbody>
</table>
</div>
<div id="the-following-variables-were-renamed" class="section level4">
<h4 class="hasAnchor">
<a href="#the-following-variables-were-renamed" class="anchor"></a>The following variables were renamed</h4>
<table>
<colgroup>
<col width="23%">
<col width="76%">
</colgroup>
<thead><tr class="header">
<th>Renamed Variables</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>game_time_eastern -&gt; start_time</td>
<td>Kickoff time in eastern time zone.</td>
</tr>
<tr class="even">
<td>site_fullname -&gt; stadium</td>
<td>Game site name.</td>
</tr>
<tr class="odd">
<td>drive_how_started -&gt; drive_start_transition</td>
<td>String indicating how the offense got the ball.</td>
</tr>
<tr class="even">
<td>drive_how_ended -&gt; drive_end_transition</td>
<td>String indicating how the offense lost the ball.</td>
</tr>
<tr class="odd">
<td>drive_start_time -&gt; drive_game_clock_start</td>
<td>Game time at the beginning of a given drive.</td>
</tr>
<tr class="even">
<td>drive_end_time -&gt; drive_game_clock_end</td>
<td>Game time at the end of a given drive.</td>
</tr>
<tr class="odd">
<td>drive_start_yardline -&gt; drive_start_yard_line</td>
<td>String indicating where a given drive started consisting of team half and yard line number.</td>
</tr>
<tr class="even">
<td>drive_end_yardline -&gt; drive_end_yard_line</td>
<td>String indicating where a given drive ended consisting of team half and yard line number.</td>
</tr>
<tr class="odd">
<td>roof_type -&gt; roof</td>
<td>One of ‘dome’, ‘outdoors’, ‘closed’, ‘open’ indicating indicating the roof status of the stadium the game was played in. (Source: Pro-Football-Reference)</td>
</tr>
</tbody>
</table>
</div>
<div id="the-following-variables-were-added" class="section level4">
<h4 class="hasAnchor">
<a href="#the-following-variables-were-added" class="anchor"></a>The following variables were added</h4>
<table>
<colgroup>
<col width="10%">
<col width="89%">
</colgroup>
<thead><tr class="header">
<th>Added Variables</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>vegas_wp</td>
<td>Estimated win probabiity for the posteam given the current situation at the start of the given play, incorporating pre-game Vegas line.</td>
</tr>
<tr class="even">
<td>vegas_home_wp</td>
<td>Estimated win probability for the home team incorporating pre-game Vegas line.</td>
</tr>
<tr class="odd">
<td>weather</td>
<td>String describing the weather including temperature, humidity and wind (direction and speed). Doesn’t change during the game!</td>
</tr>
<tr class="even">
<td>nfl_api_id</td>
<td>UUID of the game in the new NFL API.</td>
</tr>
<tr class="odd">
<td>play_clock</td>
<td>Time on the playclock when the ball was snapped.</td>
</tr>
<tr class="even">
<td>play_deleted</td>
<td>Binary indicator for deleted plays.</td>
</tr>
<tr class="odd">
<td>end_clock_time</td>
<td>Game time at the end of a given play.</td>
</tr>
<tr class="even">
<td>end_yard_line</td>
<td>String indicating the yardline at the end of the given play consisting of team half and yard line number.</td>
</tr>
<tr class="odd">
<td>drive_real_start_time</td>
<td>Local day time when the drive started (currently not used by the NFL and therefore mostly ‘NA’).</td>
</tr>
<tr class="even">
<td>drive_ended_with_score</td>
<td>Binary indicator the drive ended with a score.</td>
</tr>
<tr class="odd">
<td>drive_quarter_start</td>
<td>Numeric value indicating in which quarter the given drive has started.</td>
</tr>
<tr class="even">
<td>drive_quarter_end</td>
<td>Numeric value indicating in which quarter the given drive has ended.</td>
</tr>
<tr class="odd">
<td>drive_play_id_started</td>
<td>Play_id of the first play in the given drive.</td>
</tr>
<tr class="even">
<td>drive_play_id_ended</td>
<td>Play_id of the last play in the given drive.</td>
</tr>
<tr class="odd">
<td>away_score</td>
<td>Total points scored by the away team.</td>
</tr>
<tr class="even">
<td>home_score</td>
<td>Total points scored by the home team.</td>
</tr>
<tr class="odd">
<td>location</td>
<td>Either ‘Home’ o ‘Neutral’ indicating if the home team played at home or at a neutral site.</td>
</tr>
<tr class="even">
<td>result</td>
<td>Equals home_score - away_score and means the game outcome from the perspective of the home team.</td>
</tr>
<tr class="odd">
<td>total</td>
<td>Equals home_score + away_score and means the total points scored in the given game.</td>
</tr>
<tr class="even">
<td>spread_line</td>
<td>The closing spread line for the game. A positive number means the home team was favored by that many points, a negative number means the away team was favored by that many points. (Source: Pro-Football-Reference)</td>
</tr>
<tr class="odd">
<td>total_line</td>
<td>The closing total line for the game. (Source: Pro-Football-Reference)</td>
</tr>
<tr class="even">
<td>div_game</td>
<td>Binary indicator for if the given game was a division game.</td>
</tr>
<tr class="odd">
<td>roof</td>
<td>One of ‘dome’, ‘outdoors’, ‘closed’, ‘open’ indicating indicating the roof status of the stadium the game was played in. (Source: Pro-Football-Reference)</td>
</tr>
<tr class="even">
<td>surface</td>
<td>What type of ground the game was played on. (Source: Pro-Football-Reference)</td>
</tr>
<tr class="odd">
<td>temp</td>
<td>The temperature at the stadium only for ‘roof’ = ‘outdoors’ or ‘open’.(Source: Pro-Football-Reference)</td>
</tr>
<tr class="even">
<td>wind</td>
<td>The speed of the wind in miles/hour only for ‘roof’ = ‘outdoors’ or ‘open’. (Source: Pro-Football-Reference)</td>
</tr>
<tr class="odd">
<td>home_coach</td>
<td>First and last name of the home team coach. (Source: Pro-Football-Reference)</td>
</tr>
<tr class="even">
<td>away_coach</td>
<td>First and last name of the away team coach. (Source: Pro-Football-Reference)</td>
</tr>
<tr class="odd">
<td>stadium_id</td>
<td>ID of the stadium the game was played in. (Source: Pro-Football-Reference)</td>
</tr>
<tr class="even">
<td>game_stadium</td>
<td>Name of the stadium the game was played in. (Source: Pro-Football-Reference)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>

</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://twitter.com/mrcaseb'>Sebastian Carl</a>, <a href='https://twitter.com/benbbaldwin'>Ben Baldwin</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: 'e3fe78f73c8f37b971f8119095349ecb',
    indexName: 'nflfastr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


