<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="nflfastR">
<title>A beginner's guide to nflfastR • nflfastR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><link href="../deps/_Roboto-0.4.1/font.css" rel="stylesheet">
<link href="../deps/_Kanit-0.4.1/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="A beginner's guide to nflfastR">
<meta property="og:description" content="nflfastR">
<meta property="og:image" content="https://www.nflfastr.com/reference/figures/card.png">
<meta property="og:image:alt" content="nflfastR social preview card">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@nflfastR">
<meta name="twitter:site" content="@nflfastR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-8FNRBBEHML"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-8FNRBBEHML');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">nflfastR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.3.0.9014</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/nflfastR.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/beginners_guide.html">A beginner’s guide to nflfastR</a>
    <a class="dropdown-item" href="../articles/field_descriptions.html">Field Descriptions</a>
    <a class="external-link dropdown-item" href="https://www.opensourcefootball.com/posts/2020-09-28-nflfastr-ep-wp-and-cp-models/">nflfastR models</a>
    <a class="external-link dropdown-item" href="https://www.opensourcefootball.com/">Open Source Football</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/nflverse/nflfastR-data">
    <span class="fas fa fas fa-database fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://rbsdm.com/stats/">
    <span class="fas fa fas fa-chart-line fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="http://nflgamedata.com/">
    <span class="fas fa fas fa-football-ball fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="http://twitter.com/nflfastR">
    <span class="fab fa fab fa-twitter fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://discord.com/invite/5Er2FBnnQa">
    <span class="fab fa fab fa-discord fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/nflverse/nflfastR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-packages-amp-more">Packages &amp; More</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-packages-amp-more">
    <h6 class="dropdown-header" data-toc-skip>nflverse Packages</h6>
    <a class="dropdown-item" href="https://www.nflfastr.com">nflfastR</a>
    <a class="external-link dropdown-item" href="https://nflseedr.com">nflseedR</a>
    <a class="external-link dropdown-item" href="https://www.nfl4th.com">nfl4th</a>
    <a class="external-link dropdown-item" href="https://nflreadr.nflverse.com/">nflreadr</a>
    <a class="external-link dropdown-item" href="https://nflplotr.nflverse.com/">nflplotR</a>
    <a class="external-link dropdown-item" href="https://nflverse.nflverse.com/">nflverse</a>
    <a class="external-link dropdown-item" href="https://www.opensourcefootball.com">Open Source Football</a>
    <h6 class="dropdown-header" data-toc-skip>nflverse Data</h6>
    <a class="external-link dropdown-item" href="https://github.com/nflverse">nflverse GitHub</a>
    <a class="external-link dropdown-item" href="https://jthomasmock.github.io/espnscrapeR/">espnscrapeR Package</a>
    <h6 class="dropdown-header" data-toc-skip>ffverse</h6>
    <a class="external-link dropdown-item" href="https://www.ffverse.com">ffverse.com</a>
  </div>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>A beginner's guide to nflfastR</h1>
                        <h4 data-toc-skip class="author">Ben Baldwin</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/nflverse/nflfastR/blob/HEAD/vignettes/beginners_guide.Rmd" class="external-link"><code>vignettes/beginners_guide.Rmd</code></a></small>
      <div class="d-none name"><code>beginners_guide.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The following guide will assume you have R installed. I also highly recommend working in RStudio. If you need help getting those installed or are unfamiliar with how RStudio is laid out, <a href="https://github.com/leesharpe/nfldata/blob/master/RSTUDIO-INTRO.md#r-and-rstudio-introduction" class="external-link">please see this section of Lee Sharpe’s guide</a>.</p>
<p>A quick word if you’re new to programming: all of this is happening in R. Obviously, you need to install R on your computer to do any of this. Make sure you save what you’re doing in a script (in RStudio, File –&gt; New File –&gt; R script) so you can save your work and run multiple lines of code at once. To run code from a script, highlight what you want, and press control + enter or press the Run button in the top of the editor (see Lee’s guide). If you don’t highlight anything and press control + enter, the currently selected line will run. As you go through your R journey, you might get stuck and have to google a bunch of things, but that’s totally okay and normal. That’s how I got started!</p>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>First, you need to install the magic packages. You only need to run this step once on a given computer. For these you can just type them into the RStudio console (look for the Console pane in RStudio) directly since you’re never going to be doing this again.</p>
<div class="section level3">
<h3 id="install-packages">Install packages<a class="anchor" aria-label="anchor" href="#install-packages"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"tidyverse"</span>, type <span class="op">=</span> <span class="st">"binary"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ggrepel"</span>, type <span class="op">=</span> <span class="st">"binary"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ggimage"</span>, type <span class="op">=</span> <span class="st">"binary"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"nflfastR"</span>, type <span class="op">=</span> <span class="st">"binary"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="load-packages">Load packages<a class="anchor" aria-label="anchor" href="#load-packages"></a>
</h3>
<p>Okay, now here’s the stuff you’re going to want to start putting into your R script. The following loads <code>tidyverse</code>, which contains a lot of helper functions for working with data, and <code>ggrepel</code> and <code>ggimage</code> for making figures, along with <code>nflfastR</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/slowkow/ggrepel" class="external-link">ggrepel</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/GuangchuangYu/ggimage" class="external-link">ggimage</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.nflfastr.com/">nflfastR</a></span><span class="op">)</span></code></pre></div>
<p>This one is optional but makes R prefer not to display numbers in scientific notation, which I find very annoying:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>scipen <span class="op">=</span> <span class="fl">9999</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="load-data">Load data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h3>
<p>This will load the full play by play for the 2019 season (including playoffs). We’ll get to how to get more seasons later. Note that this is downloading pre-cleaned data from the nflfastR data repository using the <code><a href="../reference/load_pbp.html">load_pbp()</a></code> function included in <code>nflfastR</code>, which is much faster than building pbp from scratch.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_pbp.html">load_pbp</a></span><span class="op">(</span><span class="fl">2019</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="basics-how-to-look-at-your-data">Basics: how to look at your data<a class="anchor" aria-label="anchor" href="#basics-how-to-look-at-your-data"></a>
</h2>
<div class="section level3">
<h3 id="dimensions">Dimensions<a class="anchor" aria-label="anchor" href="#dimensions"></a>
</h3>
<p>Before moving forward, here are a few ways to get a sense of what’s in a dataframe. We can check the <strong>dim</strong>ensions of the data, and this tells us that there are <code>48034</code> rows (i.e., plays) in the data and <code>372</code> columns (variables):</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>
<span class="co">#&gt; [1] 48034   372</span></code></pre></div>
<p><code>str</code> displays the <strong>str</strong>ucture of the dataframe:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; nflverse_data [48,034 × 10] (S3: nflverse_data/tbl_df/tbl/data.table/data.frame)</span>
<span class="co">#&gt;  $ play_id     : num [1:48034] 1 36 51 79 100 121 148 185 214 239 ...</span>
<span class="co">#&gt;  $ game_id     : chr [1:48034] "2019_01_ATL_MIN" "2019_01_ATL_MIN" "2019_01_ATL_MIN" "2019_01_ATL_MIN" ...</span>
<span class="co">#&gt;  $ old_game_id : chr [1:48034] "2019090804" "2019090804" "2019090804" "2019090804" ...</span>
<span class="co">#&gt;  $ home_team   : chr [1:48034] "MIN" "MIN" "MIN" "MIN" ...</span>
<span class="co">#&gt;  $ away_team   : chr [1:48034] "ATL" "ATL" "ATL" "ATL" ...</span>
<span class="co">#&gt;  $ season_type : chr [1:48034] "REG" "REG" "REG" "REG" ...</span>
<span class="co">#&gt;  $ week        : int [1:48034] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ posteam     : chr [1:48034] NA "ATL" "ATL" "ATL" ...</span>
<span class="co">#&gt;  $ posteam_type: chr [1:48034] NA "away" "away" "away" ...</span>
<span class="co">#&gt;  $ defteam     : chr [1:48034] NA "MIN" "MIN" "MIN" ...</span>
<span class="co">#&gt;  - attr(*, "nflverse_timestamp")= POSIXct[1:1], format: "2022-05-31 19:46:13"</span>
<span class="co">#&gt;  - attr(*, "nflverse_type")= chr "play by play"</span></code></pre></div>
<p>In the above, I’ve added in the <code>[1:10]</code>, which selects only the first 10 columns, otherwise the list is extremely long (remember from above that there are <code>372</code> columns!).</p>
</div>
<div class="section level3">
<h3 id="variable-names">Variable names<a class="anchor" aria-label="anchor" href="#variable-names"></a>
</h3>
<p>Another very useful command is to get the <code>names</code> of the variables in the data:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>
<span class="co">#&gt;   [1] "play_id"                             </span>
<span class="co">#&gt;   [2] "game_id"                             </span>
<span class="co">#&gt;   [3] "old_game_id"                         </span>
<span class="co">#&gt;   [4] "home_team"                           </span>
<span class="co">#&gt;   [5] "away_team"                           </span>
<span class="co">#&gt;   [6] "season_type"                         </span>
<span class="co">#&gt;   [7] "week"                                </span>
<span class="co">#&gt;   [8] "posteam"                             </span>
<span class="co">#&gt;   [9] "posteam_type"                        </span>
<span class="co">#&gt;  [10] "defteam"                             </span>
<span class="co">#&gt;  [11] "side_of_field"                       </span>
<span class="co">#&gt;  [12] "yardline_100"                        </span>
<span class="co">#&gt;  [13] "game_date"                           </span>
<span class="co">#&gt;  [14] "quarter_seconds_remaining"           </span>
<span class="co">#&gt;  [15] "half_seconds_remaining"              </span>
<span class="co">#&gt;  [16] "game_seconds_remaining"              </span>
<span class="co">#&gt;  [17] "game_half"                           </span>
<span class="co">#&gt;  [18] "quarter_end"                         </span>
<span class="co">#&gt;  [19] "drive"                               </span>
<span class="co">#&gt;  [20] "sp"                                  </span>
<span class="co">#&gt;  [21] "qtr"                                 </span>
<span class="co">#&gt;  [22] "down"                                </span>
<span class="co">#&gt;  [23] "goal_to_go"                          </span>
<span class="co">#&gt;  [24] "time"                                </span>
<span class="co">#&gt;  [25] "yrdln"                               </span>
<span class="co">#&gt;  [26] "ydstogo"                             </span>
<span class="co">#&gt;  [27] "ydsnet"                              </span>
<span class="co">#&gt;  [28] "desc"                                </span>
<span class="co">#&gt;  [29] "play_type"                           </span>
<span class="co">#&gt;  [30] "yards_gained"                        </span>
<span class="co">#&gt;  [31] "shotgun"                             </span>
<span class="co">#&gt;  [32] "no_huddle"                           </span>
<span class="co">#&gt;  [33] "qb_dropback"                         </span>
<span class="co">#&gt;  [34] "qb_kneel"                            </span>
<span class="co">#&gt;  [35] "qb_spike"                            </span>
<span class="co">#&gt;  [36] "qb_scramble"                         </span>
<span class="co">#&gt;  [37] "pass_length"                         </span>
<span class="co">#&gt;  [38] "pass_location"                       </span>
<span class="co">#&gt;  [39] "air_yards"                           </span>
<span class="co">#&gt;  [40] "yards_after_catch"                   </span>
<span class="co">#&gt;  [41] "run_location"                        </span>
<span class="co">#&gt;  [42] "run_gap"                             </span>
<span class="co">#&gt;  [43] "field_goal_result"                   </span>
<span class="co">#&gt;  [44] "kick_distance"                       </span>
<span class="co">#&gt;  [45] "extra_point_result"                  </span>
<span class="co">#&gt;  [46] "two_point_conv_result"               </span>
<span class="co">#&gt;  [47] "home_timeouts_remaining"             </span>
<span class="co">#&gt;  [48] "away_timeouts_remaining"             </span>
<span class="co">#&gt;  [49] "timeout"                             </span>
<span class="co">#&gt;  [50] "timeout_team"                        </span>
<span class="co">#&gt;  [51] "td_team"                             </span>
<span class="co">#&gt;  [52] "td_player_name"                      </span>
<span class="co">#&gt;  [53] "td_player_id"                        </span>
<span class="co">#&gt;  [54] "posteam_timeouts_remaining"          </span>
<span class="co">#&gt;  [55] "defteam_timeouts_remaining"          </span>
<span class="co">#&gt;  [56] "total_home_score"                    </span>
<span class="co">#&gt;  [57] "total_away_score"                    </span>
<span class="co">#&gt;  [58] "posteam_score"                       </span>
<span class="co">#&gt;  [59] "defteam_score"                       </span>
<span class="co">#&gt;  [60] "score_differential"                  </span>
<span class="co">#&gt;  [61] "posteam_score_post"                  </span>
<span class="co">#&gt;  [62] "defteam_score_post"                  </span>
<span class="co">#&gt;  [63] "score_differential_post"             </span>
<span class="co">#&gt;  [64] "no_score_prob"                       </span>
<span class="co">#&gt;  [65] "opp_fg_prob"                         </span>
<span class="co">#&gt;  [66] "opp_safety_prob"                     </span>
<span class="co">#&gt;  [67] "opp_td_prob"                         </span>
<span class="co">#&gt;  [68] "fg_prob"                             </span>
<span class="co">#&gt;  [69] "safety_prob"                         </span>
<span class="co">#&gt;  [70] "td_prob"                             </span>
<span class="co">#&gt;  [71] "extra_point_prob"                    </span>
<span class="co">#&gt;  [72] "two_point_conversion_prob"           </span>
<span class="co">#&gt;  [73] "ep"                                  </span>
<span class="co">#&gt;  [74] "epa"                                 </span>
<span class="co">#&gt;  [75] "total_home_epa"                      </span>
<span class="co">#&gt;  [76] "total_away_epa"                      </span>
<span class="co">#&gt;  [77] "total_home_rush_epa"                 </span>
<span class="co">#&gt;  [78] "total_away_rush_epa"                 </span>
<span class="co">#&gt;  [79] "total_home_pass_epa"                 </span>
<span class="co">#&gt;  [80] "total_away_pass_epa"                 </span>
<span class="co">#&gt;  [81] "air_epa"                             </span>
<span class="co">#&gt;  [82] "yac_epa"                             </span>
<span class="co">#&gt;  [83] "comp_air_epa"                        </span>
<span class="co">#&gt;  [84] "comp_yac_epa"                        </span>
<span class="co">#&gt;  [85] "total_home_comp_air_epa"             </span>
<span class="co">#&gt;  [86] "total_away_comp_air_epa"             </span>
<span class="co">#&gt;  [87] "total_home_comp_yac_epa"             </span>
<span class="co">#&gt;  [88] "total_away_comp_yac_epa"             </span>
<span class="co">#&gt;  [89] "total_home_raw_air_epa"              </span>
<span class="co">#&gt;  [90] "total_away_raw_air_epa"              </span>
<span class="co">#&gt;  [91] "total_home_raw_yac_epa"              </span>
<span class="co">#&gt;  [92] "total_away_raw_yac_epa"              </span>
<span class="co">#&gt;  [93] "wp"                                  </span>
<span class="co">#&gt;  [94] "def_wp"                              </span>
<span class="co">#&gt;  [95] "home_wp"                             </span>
<span class="co">#&gt;  [96] "away_wp"                             </span>
<span class="co">#&gt;  [97] "wpa"                                 </span>
<span class="co">#&gt;  [98] "vegas_wpa"                           </span>
<span class="co">#&gt;  [99] "vegas_home_wpa"                      </span>
<span class="co">#&gt; [100] "home_wp_post"                        </span>
<span class="co">#&gt; [101] "away_wp_post"                        </span>
<span class="co">#&gt; [102] "vegas_wp"                            </span>
<span class="co">#&gt; [103] "vegas_home_wp"                       </span>
<span class="co">#&gt; [104] "total_home_rush_wpa"                 </span>
<span class="co">#&gt; [105] "total_away_rush_wpa"                 </span>
<span class="co">#&gt; [106] "total_home_pass_wpa"                 </span>
<span class="co">#&gt; [107] "total_away_pass_wpa"                 </span>
<span class="co">#&gt; [108] "air_wpa"                             </span>
<span class="co">#&gt; [109] "yac_wpa"                             </span>
<span class="co">#&gt; [110] "comp_air_wpa"                        </span>
<span class="co">#&gt; [111] "comp_yac_wpa"                        </span>
<span class="co">#&gt; [112] "total_home_comp_air_wpa"             </span>
<span class="co">#&gt; [113] "total_away_comp_air_wpa"             </span>
<span class="co">#&gt; [114] "total_home_comp_yac_wpa"             </span>
<span class="co">#&gt; [115] "total_away_comp_yac_wpa"             </span>
<span class="co">#&gt; [116] "total_home_raw_air_wpa"              </span>
<span class="co">#&gt; [117] "total_away_raw_air_wpa"              </span>
<span class="co">#&gt; [118] "total_home_raw_yac_wpa"              </span>
<span class="co">#&gt; [119] "total_away_raw_yac_wpa"              </span>
<span class="co">#&gt; [120] "punt_blocked"                        </span>
<span class="co">#&gt; [121] "first_down_rush"                     </span>
<span class="co">#&gt; [122] "first_down_pass"                     </span>
<span class="co">#&gt; [123] "first_down_penalty"                  </span>
<span class="co">#&gt; [124] "third_down_converted"                </span>
<span class="co">#&gt; [125] "third_down_failed"                   </span>
<span class="co">#&gt; [126] "fourth_down_converted"               </span>
<span class="co">#&gt; [127] "fourth_down_failed"                  </span>
<span class="co">#&gt; [128] "incomplete_pass"                     </span>
<span class="co">#&gt; [129] "touchback"                           </span>
<span class="co">#&gt; [130] "interception"                        </span>
<span class="co">#&gt; [131] "punt_inside_twenty"                  </span>
<span class="co">#&gt; [132] "punt_in_endzone"                     </span>
<span class="co">#&gt; [133] "punt_out_of_bounds"                  </span>
<span class="co">#&gt; [134] "punt_downed"                         </span>
<span class="co">#&gt; [135] "punt_fair_catch"                     </span>
<span class="co">#&gt; [136] "kickoff_inside_twenty"               </span>
<span class="co">#&gt; [137] "kickoff_in_endzone"                  </span>
<span class="co">#&gt; [138] "kickoff_out_of_bounds"               </span>
<span class="co">#&gt; [139] "kickoff_downed"                      </span>
<span class="co">#&gt; [140] "kickoff_fair_catch"                  </span>
<span class="co">#&gt; [141] "fumble_forced"                       </span>
<span class="co">#&gt; [142] "fumble_not_forced"                   </span>
<span class="co">#&gt; [143] "fumble_out_of_bounds"                </span>
<span class="co">#&gt; [144] "solo_tackle"                         </span>
<span class="co">#&gt; [145] "safety"                              </span>
<span class="co">#&gt; [146] "penalty"                             </span>
<span class="co">#&gt; [147] "tackled_for_loss"                    </span>
<span class="co">#&gt; [148] "fumble_lost"                         </span>
<span class="co">#&gt; [149] "own_kickoff_recovery"                </span>
<span class="co">#&gt; [150] "own_kickoff_recovery_td"             </span>
<span class="co">#&gt; [151] "qb_hit"                              </span>
<span class="co">#&gt; [152] "rush_attempt"                        </span>
<span class="co">#&gt; [153] "pass_attempt"                        </span>
<span class="co">#&gt; [154] "sack"                                </span>
<span class="co">#&gt; [155] "touchdown"                           </span>
<span class="co">#&gt; [156] "pass_touchdown"                      </span>
<span class="co">#&gt; [157] "rush_touchdown"                      </span>
<span class="co">#&gt; [158] "return_touchdown"                    </span>
<span class="co">#&gt; [159] "extra_point_attempt"                 </span>
<span class="co">#&gt; [160] "two_point_attempt"                   </span>
<span class="co">#&gt; [161] "field_goal_attempt"                  </span>
<span class="co">#&gt; [162] "kickoff_attempt"                     </span>
<span class="co">#&gt; [163] "punt_attempt"                        </span>
<span class="co">#&gt; [164] "fumble"                              </span>
<span class="co">#&gt; [165] "complete_pass"                       </span>
<span class="co">#&gt; [166] "assist_tackle"                       </span>
<span class="co">#&gt; [167] "lateral_reception"                   </span>
<span class="co">#&gt; [168] "lateral_rush"                        </span>
<span class="co">#&gt; [169] "lateral_return"                      </span>
<span class="co">#&gt; [170] "lateral_recovery"                    </span>
<span class="co">#&gt; [171] "passer_player_id"                    </span>
<span class="co">#&gt; [172] "passer_player_name"                  </span>
<span class="co">#&gt; [173] "passing_yards"                       </span>
<span class="co">#&gt; [174] "receiver_player_id"                  </span>
<span class="co">#&gt; [175] "receiver_player_name"                </span>
<span class="co">#&gt; [176] "receiving_yards"                     </span>
<span class="co">#&gt; [177] "rusher_player_id"                    </span>
<span class="co">#&gt; [178] "rusher_player_name"                  </span>
<span class="co">#&gt; [179] "rushing_yards"                       </span>
<span class="co">#&gt; [180] "lateral_receiver_player_id"          </span>
<span class="co">#&gt; [181] "lateral_receiver_player_name"        </span>
<span class="co">#&gt; [182] "lateral_receiving_yards"             </span>
<span class="co">#&gt; [183] "lateral_rusher_player_id"            </span>
<span class="co">#&gt; [184] "lateral_rusher_player_name"          </span>
<span class="co">#&gt; [185] "lateral_rushing_yards"               </span>
<span class="co">#&gt; [186] "lateral_sack_player_id"              </span>
<span class="co">#&gt; [187] "lateral_sack_player_name"            </span>
<span class="co">#&gt; [188] "interception_player_id"              </span>
<span class="co">#&gt; [189] "interception_player_name"            </span>
<span class="co">#&gt; [190] "lateral_interception_player_id"      </span>
<span class="co">#&gt; [191] "lateral_interception_player_name"    </span>
<span class="co">#&gt; [192] "punt_returner_player_id"             </span>
<span class="co">#&gt; [193] "punt_returner_player_name"           </span>
<span class="co">#&gt; [194] "lateral_punt_returner_player_id"     </span>
<span class="co">#&gt; [195] "lateral_punt_returner_player_name"   </span>
<span class="co">#&gt; [196] "kickoff_returner_player_name"        </span>
<span class="co">#&gt; [197] "kickoff_returner_player_id"          </span>
<span class="co">#&gt; [198] "lateral_kickoff_returner_player_id"  </span>
<span class="co">#&gt; [199] "lateral_kickoff_returner_player_name"</span>
<span class="co">#&gt; [200] "punter_player_id"                    </span>
<span class="co">#&gt; [201] "punter_player_name"                  </span>
<span class="co">#&gt; [202] "kicker_player_name"                  </span>
<span class="co">#&gt; [203] "kicker_player_id"                    </span>
<span class="co">#&gt; [204] "own_kickoff_recovery_player_id"      </span>
<span class="co">#&gt; [205] "own_kickoff_recovery_player_name"    </span>
<span class="co">#&gt; [206] "blocked_player_id"                   </span>
<span class="co">#&gt; [207] "blocked_player_name"                 </span>
<span class="co">#&gt; [208] "tackle_for_loss_1_player_id"         </span>
<span class="co">#&gt; [209] "tackle_for_loss_1_player_name"       </span>
<span class="co">#&gt; [210] "tackle_for_loss_2_player_id"         </span>
<span class="co">#&gt; [211] "tackle_for_loss_2_player_name"       </span>
<span class="co">#&gt; [212] "qb_hit_1_player_id"                  </span>
<span class="co">#&gt; [213] "qb_hit_1_player_name"                </span>
<span class="co">#&gt; [214] "qb_hit_2_player_id"                  </span>
<span class="co">#&gt; [215] "qb_hit_2_player_name"                </span>
<span class="co">#&gt; [216] "forced_fumble_player_1_team"         </span>
<span class="co">#&gt; [217] "forced_fumble_player_1_player_id"    </span>
<span class="co">#&gt; [218] "forced_fumble_player_1_player_name"  </span>
<span class="co">#&gt; [219] "forced_fumble_player_2_team"         </span>
<span class="co">#&gt; [220] "forced_fumble_player_2_player_id"    </span>
<span class="co">#&gt; [221] "forced_fumble_player_2_player_name"  </span>
<span class="co">#&gt; [222] "solo_tackle_1_team"                  </span>
<span class="co">#&gt; [223] "solo_tackle_2_team"                  </span>
<span class="co">#&gt; [224] "solo_tackle_1_player_id"             </span>
<span class="co">#&gt; [225] "solo_tackle_2_player_id"             </span>
<span class="co">#&gt; [226] "solo_tackle_1_player_name"           </span>
<span class="co">#&gt; [227] "solo_tackle_2_player_name"           </span>
<span class="co">#&gt; [228] "assist_tackle_1_player_id"           </span>
<span class="co">#&gt; [229] "assist_tackle_1_player_name"         </span>
<span class="co">#&gt; [230] "assist_tackle_1_team"                </span>
<span class="co">#&gt; [231] "assist_tackle_2_player_id"           </span>
<span class="co">#&gt; [232] "assist_tackle_2_player_name"         </span>
<span class="co">#&gt; [233] "assist_tackle_2_team"                </span>
<span class="co">#&gt; [234] "assist_tackle_3_player_id"           </span>
<span class="co">#&gt; [235] "assist_tackle_3_player_name"         </span>
<span class="co">#&gt; [236] "assist_tackle_3_team"                </span>
<span class="co">#&gt; [237] "assist_tackle_4_player_id"           </span>
<span class="co">#&gt; [238] "assist_tackle_4_player_name"         </span>
<span class="co">#&gt; [239] "assist_tackle_4_team"                </span>
<span class="co">#&gt; [240] "tackle_with_assist"                  </span>
<span class="co">#&gt; [241] "tackle_with_assist_1_player_id"      </span>
<span class="co">#&gt; [242] "tackle_with_assist_1_player_name"    </span>
<span class="co">#&gt; [243] "tackle_with_assist_1_team"           </span>
<span class="co">#&gt; [244] "tackle_with_assist_2_player_id"      </span>
<span class="co">#&gt; [245] "tackle_with_assist_2_player_name"    </span>
<span class="co">#&gt; [246] "tackle_with_assist_2_team"           </span>
<span class="co">#&gt; [247] "pass_defense_1_player_id"            </span>
<span class="co">#&gt; [248] "pass_defense_1_player_name"          </span>
<span class="co">#&gt; [249] "pass_defense_2_player_id"            </span>
<span class="co">#&gt; [250] "pass_defense_2_player_name"          </span>
<span class="co">#&gt; [251] "fumbled_1_team"                      </span>
<span class="co">#&gt; [252] "fumbled_1_player_id"                 </span>
<span class="co">#&gt; [253] "fumbled_1_player_name"               </span>
<span class="co">#&gt; [254] "fumbled_2_player_id"                 </span>
<span class="co">#&gt; [255] "fumbled_2_player_name"               </span>
<span class="co">#&gt; [256] "fumbled_2_team"                      </span>
<span class="co">#&gt; [257] "fumble_recovery_1_team"              </span>
<span class="co">#&gt; [258] "fumble_recovery_1_yards"             </span>
<span class="co">#&gt; [259] "fumble_recovery_1_player_id"         </span>
<span class="co">#&gt; [260] "fumble_recovery_1_player_name"       </span>
<span class="co">#&gt; [261] "fumble_recovery_2_team"              </span>
<span class="co">#&gt; [262] "fumble_recovery_2_yards"             </span>
<span class="co">#&gt; [263] "fumble_recovery_2_player_id"         </span>
<span class="co">#&gt; [264] "fumble_recovery_2_player_name"       </span>
<span class="co">#&gt; [265] "sack_player_id"                      </span>
<span class="co">#&gt; [266] "sack_player_name"                    </span>
<span class="co">#&gt; [267] "half_sack_1_player_id"               </span>
<span class="co">#&gt; [268] "half_sack_1_player_name"             </span>
<span class="co">#&gt; [269] "half_sack_2_player_id"               </span>
<span class="co">#&gt; [270] "half_sack_2_player_name"             </span>
<span class="co">#&gt; [271] "return_team"                         </span>
<span class="co">#&gt; [272] "return_yards"                        </span>
<span class="co">#&gt; [273] "penalty_team"                        </span>
<span class="co">#&gt; [274] "penalty_player_id"                   </span>
<span class="co">#&gt; [275] "penalty_player_name"                 </span>
<span class="co">#&gt; [276] "penalty_yards"                       </span>
<span class="co">#&gt; [277] "replay_or_challenge"                 </span>
<span class="co">#&gt; [278] "replay_or_challenge_result"          </span>
<span class="co">#&gt; [279] "penalty_type"                        </span>
<span class="co">#&gt; [280] "defensive_two_point_attempt"         </span>
<span class="co">#&gt; [281] "defensive_two_point_conv"            </span>
<span class="co">#&gt; [282] "defensive_extra_point_attempt"       </span>
<span class="co">#&gt; [283] "defensive_extra_point_conv"          </span>
<span class="co">#&gt; [284] "safety_player_name"                  </span>
<span class="co">#&gt; [285] "safety_player_id"                    </span>
<span class="co">#&gt; [286] "season"                              </span>
<span class="co">#&gt; [287] "cp"                                  </span>
<span class="co">#&gt; [288] "cpoe"                                </span>
<span class="co">#&gt; [289] "series"                              </span>
<span class="co">#&gt; [290] "series_success"                      </span>
<span class="co">#&gt; [291] "series_result"                       </span>
<span class="co">#&gt; [292] "order_sequence"                      </span>
<span class="co">#&gt; [293] "start_time"                          </span>
<span class="co">#&gt; [294] "time_of_day"                         </span>
<span class="co">#&gt; [295] "stadium"                             </span>
<span class="co">#&gt; [296] "weather"                             </span>
<span class="co">#&gt; [297] "nfl_api_id"                          </span>
<span class="co">#&gt; [298] "play_clock"                          </span>
<span class="co">#&gt; [299] "play_deleted"                        </span>
<span class="co">#&gt; [300] "play_type_nfl"                       </span>
<span class="co">#&gt; [301] "special_teams_play"                  </span>
<span class="co">#&gt; [302] "st_play_type"                        </span>
<span class="co">#&gt; [303] "end_clock_time"                      </span>
<span class="co">#&gt; [304] "end_yard_line"                       </span>
<span class="co">#&gt; [305] "fixed_drive"                         </span>
<span class="co">#&gt; [306] "fixed_drive_result"                  </span>
<span class="co">#&gt; [307] "drive_real_start_time"               </span>
<span class="co">#&gt; [308] "drive_play_count"                    </span>
<span class="co">#&gt; [309] "drive_time_of_possession"            </span>
<span class="co">#&gt; [310] "drive_first_downs"                   </span>
<span class="co">#&gt; [311] "drive_inside20"                      </span>
<span class="co">#&gt; [312] "drive_ended_with_score"              </span>
<span class="co">#&gt; [313] "drive_quarter_start"                 </span>
<span class="co">#&gt; [314] "drive_quarter_end"                   </span>
<span class="co">#&gt; [315] "drive_yards_penalized"               </span>
<span class="co">#&gt; [316] "drive_start_transition"              </span>
<span class="co">#&gt; [317] "drive_end_transition"                </span>
<span class="co">#&gt; [318] "drive_game_clock_start"              </span>
<span class="co">#&gt; [319] "drive_game_clock_end"                </span>
<span class="co">#&gt; [320] "drive_start_yard_line"               </span>
<span class="co">#&gt; [321] "drive_end_yard_line"                 </span>
<span class="co">#&gt; [322] "drive_play_id_started"               </span>
<span class="co">#&gt; [323] "drive_play_id_ended"                 </span>
<span class="co">#&gt; [324] "away_score"                          </span>
<span class="co">#&gt; [325] "home_score"                          </span>
<span class="co">#&gt; [326] "location"                            </span>
<span class="co">#&gt; [327] "result"                              </span>
<span class="co">#&gt; [328] "total"                               </span>
<span class="co">#&gt; [329] "spread_line"                         </span>
<span class="co">#&gt; [330] "total_line"                          </span>
<span class="co">#&gt; [331] "div_game"                            </span>
<span class="co">#&gt; [332] "roof"                                </span>
<span class="co">#&gt; [333] "surface"                             </span>
<span class="co">#&gt; [334] "temp"                                </span>
<span class="co">#&gt; [335] "wind"                                </span>
<span class="co">#&gt; [336] "home_coach"                          </span>
<span class="co">#&gt; [337] "away_coach"                          </span>
<span class="co">#&gt; [338] "stadium_id"                          </span>
<span class="co">#&gt; [339] "game_stadium"                        </span>
<span class="co">#&gt; [340] "aborted_play"                        </span>
<span class="co">#&gt; [341] "success"                             </span>
<span class="co">#&gt; [342] "passer"                              </span>
<span class="co">#&gt; [343] "passer_jersey_number"                </span>
<span class="co">#&gt; [344] "rusher"                              </span>
<span class="co">#&gt; [345] "rusher_jersey_number"                </span>
<span class="co">#&gt; [346] "receiver"                            </span>
<span class="co">#&gt; [347] "receiver_jersey_number"              </span>
<span class="co">#&gt; [348] "pass"                                </span>
<span class="co">#&gt; [349] "rush"                                </span>
<span class="co">#&gt; [350] "first_down"                          </span>
<span class="co">#&gt; [351] "special"                             </span>
<span class="co">#&gt; [352] "play"                                </span>
<span class="co">#&gt; [353] "passer_id"                           </span>
<span class="co">#&gt; [354] "rusher_id"                           </span>
<span class="co">#&gt; [355] "receiver_id"                         </span>
<span class="co">#&gt; [356] "name"                                </span>
<span class="co">#&gt; [357] "jersey_number"                       </span>
<span class="co">#&gt; [358] "id"                                  </span>
<span class="co">#&gt; [359] "fantasy_player_name"                 </span>
<span class="co">#&gt; [360] "fantasy_player_id"                   </span>
<span class="co">#&gt; [361] "fantasy"                             </span>
<span class="co">#&gt; [362] "fantasy_id"                          </span>
<span class="co">#&gt; [363] "out_of_bounds"                       </span>
<span class="co">#&gt; [364] "home_opening_kickoff"                </span>
<span class="co">#&gt; [365] "qb_epa"                              </span>
<span class="co">#&gt; [366] "xyac_epa"                            </span>
<span class="co">#&gt; [367] "xyac_mean_yardage"                   </span>
<span class="co">#&gt; [368] "xyac_median_yardage"                 </span>
<span class="co">#&gt; [369] "xyac_success"                        </span>
<span class="co">#&gt; [370] "xyac_fd"                             </span>
<span class="co">#&gt; [371] "xpass"                               </span>
<span class="co">#&gt; [372] "pass_oe"</span></code></pre></div>
<p>That is a lot to work with!</p>
</div>
<div class="section level3">
<h3 id="viewer">Viewer<a class="anchor" aria-label="anchor" href="#viewer"></a>
</h3>
<p>One more way to look at your data is with the <code><a href="https://rdrr.io/r/utils/View.html" class="external-link">View()</a></code> function. If you’re coming from an Excel background, this will help you feel more at home as a way to see what’s in the data.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></code></pre></div>
<p>This will open the viewer in RStudio in a new panel. Try it out yourself! Since there are so many columns, the Viewer won’t show them all. To pick which columns to view, you can <strong>select</strong> some:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">home_team</span>, <span class="va">away_team</span>, <span class="va">posteam</span>, <span class="va">desc</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>The <code>%&gt;%</code> thing lets you pipe together a bunch of different commands. So we’re taking our data, “<code>select</code>”ing a few variables we want to look at, and then Viewing. Again, I can’t display the results of that here, but try it out yourself!</p>
</div>
<div class="section level3">
<h3 id="head-manipulation">Head + manipulation<a class="anchor" aria-label="anchor" href="#head-manipulation"></a>
</h3>
<p>To start, let’s just look at the first few rows (the “head”) of the data.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">posteam</span>, <span class="va">defteam</span>, <span class="va">desc</span>, <span class="va">rush</span>, <span class="va">pass</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; ── <span style="font-style: italic;">nflverse play by play</span> ───────────────────────────────────────────────────────</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Data updated: <span style="color: #00BB00;">2022-05-31 19:46:13 UTC</span></span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span>
<span class="co">#&gt;   posteam defteam desc                                                rush  pass</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>      GAME                                                   0     0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> ATL     MIN     5-D.Bailey kicks 65 yards from MIN 35 to end zone…     0     0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> ATL     MIN     (15:00) 2-M.Ryan sacked at ATL 17 for -8 yards (5…     0     1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> ATL     MIN     (14:20) 24-D.Freeman right tackle to ATL 21 for 4…     1     0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> ATL     MIN     (13:41) (Shotgun) 2-M.Ryan scrambles left end to …     0     1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span> ATL     MIN     (12:59) 5-M.Bosher punt is BLOCKED by 50-E.Wilson…     0     0</span></code></pre></div>
<p>A couple things. “<code>desc</code>” is the important variable that lists the description of what happened on the play, and <code>head</code> says to show the first few rows (the “head” of the data). Since this is already sorted by game, these are the first 6 rows from a week 1 game, ATL @ MIN. To make code easier to read, people often put each part of a pipe on a new line, which is useful when working with more complicated functions. We could run:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">posteam</span>, <span class="va">defteam</span>, <span class="va">desc</span>, <span class="va">rush</span>, <span class="va">pass</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>And it would return the exact same output as the one written out in multiple lines, but the code isn’t as easy to read.</p>
<p>We’ve covered <code>select</code>, and the next important function to learn is <code>filter</code>, which lets you filter the data to what you want. The following returns only plays that are run plays and pass plays; i.e., no punts, kickoffs, field goals, or dead ball penalties (e.g. false starts) where we don’t know what the attempted play was.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">rush</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">pass</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">posteam</span>, <span class="va">desc</span>, <span class="va">rush</span>, <span class="va">pass</span>, <span class="va">name</span>, <span class="va">passer</span>, <span class="va">rusher</span>, <span class="va">receiver</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; ── <span style="font-style: italic;">nflverse play by play</span> ───────────────────────────────────────────────────────</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Data updated: <span style="color: #00BB00;">2022-05-31 19:46:13 UTC</span></span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 8</span></span>
<span class="co">#&gt;   posteam desc                           rush  pass name  passer rusher receiver</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> ATL     (15:00) 2-M.Ryan sacked at A…     0     1 M.Ry… M.Ryan <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> ATL     (14:20) 24-D.Freeman right t…     1     0 D.Fr… <span style="color: #BB0000;">NA</span>     D.Fre… <span style="color: #BB0000;">NA</span>      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> ATL     (13:41) (Shotgun) 2-M.Ryan s…     0     1 M.Ry… M.Ryan <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> MIN     (12:53) 33-D.Cook right end …     1     0 D.Co… <span style="color: #BB0000;">NA</span>     D.Cook <span style="color: #BB0000;">NA</span>      </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> MIN     (12:32) 8-K.Cousins pass sho…     0     1 K.Co… K.Cou… <span style="color: #BB0000;">NA</span>     D.Cook  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span> MIN     (11:57) 8-K.Cousins pass sho…     0     1 K.Co… K.Cou… <span style="color: #BB0000;">NA</span>     A.Thiel…</span></code></pre></div>
<p>Compared to the first time we did this, the opening line for the start of the game, the kickoff, and the punt are now gone. Note that if you’re checking whether a variable is equal to something, we need to use the double equals sign <code>==</code> like above. There’s probably some technical reason for this [shrug emoji]. Also, the character <code>|</code> is used for “or”, and <code>&amp;</code> for “and”. So <code>rush == 1 | pass == 1</code> means “rush or pass”.</p>
<p>Note that the <code>rush</code>, <code>pass</code>, <code>name</code>, <code>passer</code>, <code>rusher</code>, and <code>receiver</code> columns are all <code>nflfastR</code> creations, where we have provided these to make working with the data easier. As we can see above, <code>passer</code> is filled in for all dropbacks (including sacks and scrambles, which also have <code>pass</code> = 1), and <code>name</code> is equal to the passer on pass plays and the rusher on rush plays. Think of this as the primary player involved on a play.</p>
<p>What if we wanted to view special teams plays? Again, we can use <code>filter</code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">special</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">down</span>, <span class="va">ydstogo</span>, <span class="va">desc</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; ── <span style="font-style: italic;">nflverse play by play</span> ───────────────────────────────────────────────────────</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Data updated: <span style="color: #00BB00;">2022-05-31 19:46:13 UTC</span></span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span>
<span class="co">#&gt;    down ydstogo desc                                                            </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                           </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>    <span style="color: #BB0000;">NA</span>       0 5-D.Bailey kicks 65 yards from MIN 35 to end zone, Touchback.   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     4       2 (12:59) 5-M.Bosher punt is BLOCKED by 50-E.Wilson, Center-47-J.…</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>    <span style="color: #BB0000;">NA</span>       0 (Kick formation) 5-D.Bailey extra point is GOOD, Center-58-A.Cu…</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span>    <span style="color: #BB0000;">NA</span>       0 5-D.Bailey kicks 67 yards from MIN 35 to ATL -2. 38-K.Barner to…</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span>    <span style="color: #BB0000;">NA</span>       0 (Kick formation) 5-D.Bailey extra point is GOOD, Center-58-A.Cu…</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span>    <span style="color: #BB0000;">NA</span>       0 5-D.Bailey kicks 65 yards from MIN 35 to end zone, Touchback.</span></code></pre></div>
<p>Fourth down plays?</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">down</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">down</span>, <span class="va">ydstogo</span>, <span class="va">desc</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; ── <span style="font-style: italic;">nflverse play by play</span> ───────────────────────────────────────────────────────</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Data updated: <span style="color: #00BB00;">2022-05-31 19:46:13 UTC</span></span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span>
<span class="co">#&gt;    down ydstogo desc                                                            </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                           </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     4       2 (12:59) 5-M.Bosher punt is BLOCKED by 50-E.Wilson, Center-47-J.…</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     4      19 (2:38) 5-M.Bosher punts 33 yards to MIN 8, Center-47-J.Harris, …</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     4      20 (12:33) 2-B.Colquitt punts 51 yards to ATL 17, Center-58-A.Cutt…</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     4      27 (1:49) 5-M.Bosher punts 45 yards to MIN 10, Center-47-J.Harris,…</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     4      10 (:49) 2-B.Colquitt punts 57 yards to ATL 33, Center-58-A.Cuttin…</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     4       1 (10:56) 2-B.Colquitt punts 42 yards to ATL 10, Center-58-A.Cutt…</span></code></pre></div>
<p>Fourth down plays that aren’t special teams plays?</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">down</span> <span class="op">==</span> <span class="fl">4</span> <span class="op">&amp;</span> <span class="va">special</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">down</span>, <span class="va">ydstogo</span>, <span class="va">desc</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; ── <span style="font-style: italic;">nflverse play by play</span> ───────────────────────────────────────────────────────</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Data updated: <span style="color: #00BB00;">2022-05-31 19:46:13 UTC</span></span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span>
<span class="co">#&gt;    down ydstogo desc                                                            </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                           </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     4       5 (9:25) (Shotgun) 2-M.Ryan pass deep left to 18-C.Ridley for 20 …</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     4       2 (4:39) (Punt formation) PENALTY on MIN, Delay of Game, 5 yards,…</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     4       2 (1:27) (No Huddle, Shotgun) 2-M.Ryan pass short left to 11-J.Jo…</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     4       1 (2:59) (Punt formation) Direct snap to 41-A.Levine.  41-A.Levin…</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     4       3 (9:30) (Shotgun) 3-R.Griffin pass short left to 89-M.Andrews fo…</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     4       1 (3:55) 17-J.Allen FUMBLES (Aborted) at NYJ 37, RECOVERED by NYJ…</span></code></pre></div>
<p>So far, we’ve just been taking a look at the initial dataset we downloaded, but none of our results are preserved. To save a new dataframe of just the plays we want, we need to use <code>&lt;-</code> to assign a new dataframe. Let’s save a new dataframe that’s just run plays and pass plays with non-missing EPA, called <code>pbp_rp</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbp_rp</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">rush</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">pass</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">epa</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>In the above, <code>!is.na(epa)</code> means to exclude plays with missing (<code>na</code>) EPA. The <code>!</code> symbol is often used by computer folk to negate something, so <code>is.na(epa)</code> means “EPA is missing” and <code>!is.na(epa)</code> means “EPA is not missing”, which we have used above.</p>
</div>
</div>
<div class="section level2">
<h2 id="some-basic-stuff-part-1">Some basic stuff: Part 1<a class="anchor" aria-label="anchor" href="#some-basic-stuff-part-1"></a>
</h2>
<p>Okay, we have a big dataset where we call dropbacks pass plays and non-dropbacks rush plays. Now we actually want to, like, do stuff.</p>
<div class="section level3">
<h3 id="group-by-and-summarize">Group by and Summarize<a class="anchor" aria-label="anchor" href="#group-by-and-summarize"></a>
</h3>
<p>Let’s take a look at how various Cowboys’ running backs fared on run plays in 2019:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbp_rp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">posteam</span> <span class="op">==</span> <span class="st">"DAL"</span>, <span class="va">rush</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">rusher</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>
      mean_epa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">epa</span><span class="op">)</span>, success_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">success</span><span class="op">)</span>, ypc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">yards_gained</span><span class="op">)</span>, plays <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>
      <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">mean_epa</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">plays</span> <span class="op">&gt;</span> <span class="fl">20</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span>
<span class="co">#&gt;   rusher     mean_epa success_rate   ypc plays</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> D.Prescott   0.288         0.591  6.41    22</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> T.Pollard   -<span style="color: #BB0000;">0.026</span><span style="color: #BB0000; text-decoration: underline;">5</span>        0.456  5.08    90</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> E.Elliott   -<span style="color: #BB0000;">0.041</span><span style="color: #BB0000; text-decoration: underline;">2</span>        0.411  4.39   309</span></code></pre></div>
<p>There’s a lot going on here. We’ve covered <code>filter</code> already. The <code>group_by</code> function is an <em>extremely</em> useful function that, well, groups by what you tell it – in this case the rusher. Summarize is useful for collapsing the data down to a summary of what you’re looking at, and here, while grouping by player, we’re summarizing the mean of EPA, success, yardage (a bad rushing stat, but since we’re here), and getting the number of plays using <code><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n()</a></code>, which returns the number in a group. Unsurprisingly, Prescott was much more effective as a rusher in 2019 than the running backs, and there was no meaningful difference between Pollard and Elliott in efficiency.</p>
<p>If you check the <a href="https://www.pro-football-reference.com/teams/dal/2019.htm" class="external-link">PFR team stats page</a>, you’ll notice that the above doesn’t match up with the official stats. This is because <code>nflfastR</code> computes EPA and provides player names on plays with penalties and on two-point conversions. So if wanting to match the official stats, we need to restrict to <code>down &lt;= 4</code> (to excluded two-point conversions, which have down listed as <code>NA</code>) and <code>play_type = run</code> (to exclude penalties, which are <code>play_type = no_play</code>):</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbp_rp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">posteam</span> <span class="op">==</span> <span class="st">"DAL"</span>, <span class="va">down</span> <span class="op">&lt;=</span> <span class="fl">4</span>, <span class="va">play_type</span> <span class="op">==</span> <span class="st">'run'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">rusher</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>
      mean_epa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">epa</span><span class="op">)</span>, success_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">success</span><span class="op">)</span>, ypc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">yards_gained</span><span class="op">)</span>, plays<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>
      <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">plays</span> <span class="op">&gt;</span> <span class="fl">20</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span>
<span class="co">#&gt;   rusher     mean_epa success_rate   ypc plays</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> D.Prescott   0.288         0.591  6.41    22</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> E.Elliott   -<span style="color: #BB0000;">0.018</span><span style="color: #BB0000; text-decoration: underline;">5</span>        0.422  4.51   301</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> T.Pollard   -<span style="color: #BB0000;">0.021</span><span style="color: #BB0000; text-decoration: underline;">0</span>        0.453  5.29    86</span></code></pre></div>
<p>Now we exactly match PFR: Zeke has 301 carries at 4.5 yards/carry, and Pollard has 86 carries for 5.3 yards/carry. Note that we still aren’t matching Dak’s stats to PFR because the NFL classifies scrambles as rush attempts and <code>nflfastR</code> does not.</p>
</div>
<div class="section level3">
<h3 id="manipulating-columns-mutate-if_else-and-case_when">Manipulating columns: mutate, if_else, and case_when<a class="anchor" aria-label="anchor" href="#manipulating-columns-mutate-if_else-and-case_when"></a>
</h3>
<p>Let’s say we want to make a new column, named <code>home</code>, which is equal to 1 if the team with the ball is the home team. Let’s introduce another extremely useful function, <code>if_else</code>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbp_rp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>
    home <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">posteam</span> <span class="op">==</span> <span class="va">home_team</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">posteam</span>, <span class="va">home_team</span>, <span class="va">home</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt; ── <span style="font-style: italic;">nflverse play by play</span> ───────────────────────────────────────────────────────</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Data updated: <span style="color: #00BB00;">2022-05-31 19:46:13 UTC</span></span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 3</span></span>
<span class="co">#&gt;    posteam home_team  home</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> ATL     MIN           0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> ATL     MIN           0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> ATL     MIN           0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> MIN     MIN           1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> MIN     MIN           1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> MIN     MIN           1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> ATL     MIN           0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> ATL     MIN           0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> ATL     MIN           0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> MIN     MIN           1</span></code></pre></div>
<p><code>mutate</code> is R’s word for creating a new column (or overwriting an existing one); in this case, we’ve created a new column called <code>home</code>. The above uses <code>if_else</code>, which uses the following pattern: condition (in this case, <code>posteam == home_team</code>), value if condition is true (in this case, if <code>posteam == home_team</code>, it is 1), and value if the condition is false (0). So we could use this to, for example, look at average EPA/play by home and road teams:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbp_rp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>
    home <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">posteam</span> <span class="op">==</span> <span class="va">home_team</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">home</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>epa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">epa</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span>
<span class="co">#&gt;    home     epa</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     0  0.021<span style="text-decoration: underline;">5</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1 -<span style="color: #BB0000;">0.016</span><span style="color: #BB0000; text-decoration: underline;">6</span></span></code></pre></div>
<p>Note that EPA/play is similar for home teams and away teams because <code>home</code> is already built into the <code>nflfastR</code> EPA model, so this result is expected. Actually, away EPA/play is actually somewhat higher, presumably because away teams out-performed their usual in 2019 as homefield advantage continues to decline generally.</p>
<p><code>if_else</code> is nice if you’re creating a new column based on a simple condition. But what if you need to do something more complicated? <code>case_when</code> is a good option. Here’s how it works:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbp_rp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">cp</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>
    depth <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span>
      <span class="va">air_yards</span> <span class="op">&lt;</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"Negative"</span>,
      <span class="va">air_yards</span> <span class="op">&gt;=</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">air_yards</span> <span class="op">&lt;</span> <span class="fl">10</span> <span class="op">~</span> <span class="st">"Short"</span>,
      <span class="va">air_yards</span> <span class="op">&gt;=</span> <span class="fl">10</span> <span class="op">&amp;</span> <span class="va">air_yards</span> <span class="op">&lt;</span> <span class="fl">20</span> <span class="op">~</span> <span class="st">"Medium"</span>,
      <span class="va">air_yards</span> <span class="op">&gt;=</span> <span class="fl">20</span> <span class="op">~</span> <span class="st">"Deep"</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">depth</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>cp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">cp</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 2</span></span>
<span class="co">#&gt;   depth       cp</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Deep     0.367</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Medium   0.573</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Negative 0.847</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Short    0.718</span></code></pre></div>
<p>Note the new syntax for <code>case_when</code>: we have condition (for the first one, air yards less than 0), followed by <code>~</code>, followed by assignment (for the first one, “Negative”). In the above, we created 4 bins based on air yards and got average completion probability (<code>cp</code>) based on the <code>nflfastR</code> model. Unsurprisingly, <code>cp</code> is lower the longer downfield a throw goes.</p>
</div>
<div class="section level3">
<h3 id="a-basic-figure">A basic figure<a class="anchor" aria-label="anchor" href="#a-basic-figure"></a>
</h3>
<p>Now that we’ve gained some skills at manipulating data, let’s put it to use by making things. Which teams were the most pass-heavy in the first half on early downs with win probability between 20 and 80, excluding the final 2 minutes of the half when everyone is pass-happy?</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">schotty</span> <span class="op">&lt;-</span> <span class="va">pbp_rp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">wp</span> <span class="op">&gt;</span> <span class="fl">.20</span> <span class="op">&amp;</span> <span class="va">wp</span> <span class="op">&lt;</span> <span class="fl">.80</span> <span class="op">&amp;</span> <span class="va">down</span> <span class="op">&lt;=</span> <span class="fl">2</span> <span class="op">&amp;</span> <span class="va">qtr</span> <span class="op">&lt;=</span> <span class="fl">2</span> <span class="op">&amp;</span> <span class="va">half_seconds_remaining</span> <span class="op">&gt;</span> <span class="fl">120</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">posteam</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>mean_pass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pass</span><span class="op">)</span>, plays <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">mean_pass</span><span class="op">)</span>
<span class="va">schotty</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 32 × 3</span></span>
<span class="co">#&gt;    posteam mean_pass plays</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> KC          0.691   388</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> MIA         0.594   288</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> NO          0.585   325</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> LA          0.584   329</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> CHI         0.563   309</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> CLE         0.555   272</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> CAR         0.554   271</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> TB          0.551   321</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> GB          0.550   291</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> ARI         0.548   325</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 22 more rows</span></span></code></pre></div>
<p>Again, we’ve already used <code>filter</code>, <code>group_by</code>, and <code>summarize</code>. The new function we are using here is <code>arrange</code>, which sorts the data by the variable(s) given. The minus sign in front of <code>mean_pass</code> means to sort in descending order.</p>
<p>Let’s make our first figure:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">schotty</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">posteam</span>,<span class="op">-</span><span class="va">mean_pass</span><span class="op">)</span>, y<span class="op">=</span><span class="va">mean_pass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">posteam</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="beginners_guide_files/figure-html/fig1-1.png" width="100%"></p>
<p>This image is kind of a mess – we still need a title, axis labels, etc – but gets the point across. We’ll get to that other stuff later. But more importantly, we made something interesting using <code>nflfastR</code> data! The “reorder” sorts the teams according to pass rate, with the “-” again saying to do it in descending order. “aes” is short for “aesthetic”, which is R’s weird way of asking which variables should go on the x and y axes.</p>
<p>Looking at the figure, the Chiefs will never have playoff success until they establish the run.</p>
</div>
</div>
<div class="section level2">
<h2 id="loading-multiple-seasons">Loading multiple seasons<a class="anchor" aria-label="anchor" href="#loading-multiple-seasons"></a>
</h2>
<p>Because all the data is stored in the data repository, it is very fast to load data from multiple seasons.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_pbp.html">load_pbp</a></span><span class="op">(</span><span class="fl">2015</span><span class="op">:</span><span class="fl">2019</span><span class="op">)</span></code></pre></div>
<p>This loads play-by-play data from the 2015 through 2019 seasons.</p>
<p>Let’s make sure we got it all. By now, you should understand what this is doing:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">season</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 2</span></span>
<span class="co">#&gt;   season     n</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>   <span style="text-decoration: underline;">2</span>015 <span style="text-decoration: underline;">48</span>869</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>   <span style="text-decoration: underline;">2</span>016 <span style="text-decoration: underline;">48</span>419</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>   <span style="text-decoration: underline;">2</span>017 <span style="text-decoration: underline;">47</span>997</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span>   <span style="text-decoration: underline;">2</span>018 <span style="text-decoration: underline;">47</span>874</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span>   <span style="text-decoration: underline;">2</span>019 <span style="text-decoration: underline;">48</span>034</span></code></pre></div>
<p>So each season has about 48,000 plays. Just for fun, let’s look at the various play types:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">play_type</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 2</span></span>
<span class="co">#&gt;    play_type       n</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> extra_point  <span style="text-decoration: underline;">6</span>240</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> field_goal   <span style="text-decoration: underline;">5</span>156</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> kickoff     <span style="text-decoration: underline;">13</span>614</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> no_play     <span style="text-decoration: underline;">22</span>745</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> pass        <span style="text-decoration: underline;">99</span>986</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> punt        <span style="text-decoration: underline;">12</span>083</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> qb_kneel     <span style="text-decoration: underline;">2</span>090</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> qb_spike      340</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> run         <span style="text-decoration: underline;">68</span>129</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="color: #BB0000;">NA</span>          <span style="text-decoration: underline;">10</span>810</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="figures-with-qb-stats">Figures with QB stats<a class="anchor" aria-label="anchor" href="#figures-with-qb-stats"></a>
</h2>
<p>Let’s do some stuff with quarterbacks:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">qbs</span> <span class="op">&lt;-</span> <span class="va">pbp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">season_type</span> <span class="op">==</span> <span class="st">"REG"</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">epa</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">name</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>
    epa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">qb_epa</span><span class="op">)</span>,
    cpoe <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">cpoe</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,
    n_dropbacks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pass</span><span class="op">)</span>,
    n_plays <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,
    team <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html" class="external-link">last</a></span><span class="op">(</span><span class="va">posteam</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">n_dropbacks</span> <span class="op">&gt;</span> <span class="fl">100</span> <span class="op">&amp;</span> <span class="va">n_plays</span> <span class="op">&gt;</span> <span class="fl">1000</span><span class="op">)</span>
<span class="co">#&gt; `summarise()` has grouped output by 'id'. You can override using the `.groups`</span>
<span class="co">#&gt; argument.</span></code></pre></div>
<p>Lots of new stuff here. First, we’re grouping by <code>id</code> and <code>name</code> to make sure we’re getting unique players; i.e., if two players have the same name (like Javorius Allen and Josh Allen both being J.Allen), we are also using their id to differentiate them. <code>qb_epa</code> is an <code>nflfastR</code> creation that is equal to EPA in all instances except for when a pass is completed and a fumble is lost, in which case a QB gets “credit” for the play up to the spot the fumble was lost (making EPA function like passing yards). The <code>last</code> part in the <code>summarize</code> comment gets the last team that a player was observed playing with.</p>
<p>My way of getting a dataset with only quarterbacks without joining to external roster data is to make sure they hit some number of dropbacks. In this case, filtering with <code>n_dropbacks &gt; 100</code> makes sure we’re only including quarterbacks. The <code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup()</a></code> near the end is good practice after grouping to make sure you don’t get weird behavior with the data you created down the line.</p>
<p>Let’s make some more figures. The <code>team_colors_logos</code> dataframe is provided in the <code>nflfastR</code> package, so since we have already loaded the package, it’s ready to use.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">teams_colors_logos</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 15</span></span>
<span class="co">#&gt;   team_abbr team_name       team_id team_nick team_conf team_division team_color</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> ARI       Arizona Cardin… 3800    Cardinals NFC       NFC West      #97233F   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> ATL       Atlanta Falcons 0200    Falcons   NFC       NFC South     #A71930   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> BAL       Baltimore Rave… 0325    Ravens    AFC       AFC North     #241773   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> BUF       Buffalo Bills   0610    Bills     AFC       AFC East      #00338D   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> CAR       Carolina Panth… 0750    Panthers  NFC       NFC South     #0085CA   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span> CHI       Chicago Bears   0810    Bears     NFC       NFC North     #0B162A   </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 8 more variables: team_color2 &lt;chr&gt;, team_color3 &lt;chr&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   team_color4 &lt;chr&gt;, team_logo_wikipedia &lt;chr&gt;, team_logo_espn &lt;chr&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   team_wordmark &lt;chr&gt;, team_conference_logo &lt;chr&gt;, team_league_logo &lt;chr&gt;</span></span></code></pre></div>
<p>Let’s join this to the <code>qbs</code> dataframe we created:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">qbs</span> <span class="op">&lt;-</span> <span class="va">qbs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">teams_colors_logos</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'team'</span> <span class="op">=</span> <span class="st">'team_abbr'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><code>left_join</code> means keep all the rows from the left dataframe (the first one provided, <code>qbs</code>), and join those rows to available rows in the other dataframe. We also need to provide the joining variables, <code>team</code> from <code>qbs</code> and <code>team_abbr</code> from <code>team_colors_logos</code>. Why do we have to type <code>by = c('team' = 'team_abbr')</code>? Who knows, but it’s what <code>left_join</code> requires as instructions for how to match.</p>
<div class="section level3">
<h3 id="with-team-color-dots">With team color dots<a class="anchor" aria-label="anchor" href="#with-team-color-dots"></a>
</h3>
<p>Now we can make a figure!</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">qbs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cpoe</span>, y <span class="op">=</span> <span class="va">epa</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="co">#horizontal line with mean EPA</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">qbs</span><span class="op">$</span><span class="va">epa</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="co">#vertical line with mean CPOE</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">qbs</span><span class="op">$</span><span class="va">cpoe</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="co">#add points for the QBs with the right colors</span>
  <span class="co">#cex controls point size and alpha the transparency (alpha = 1 is normal)</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">qbs</span><span class="op">$</span><span class="va">team_color</span>, cex<span class="op">=</span><span class="va">qbs</span><span class="op">$</span><span class="va">n_plays</span> <span class="op">/</span> <span class="fl">350</span>, alpha <span class="op">=</span> <span class="fl">.6</span><span class="op">)</span> <span class="op">+</span>
  <span class="co">#add names using ggrepel, which tries to make them not overlap</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html" class="external-link">geom_text_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="co">#add a smooth line fitting cpoe + epa</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">stat_smooth</a></span><span class="op">(</span>geom<span class="op">=</span><span class="st">'line'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, se<span class="op">=</span><span class="cn">FALSE</span>, method<span class="op">=</span><span class="st">'lm'</span><span class="op">)</span><span class="op">+</span>
  <span class="co">#titles and caption</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Completion % above expected (CPOE)"</span>,
       y <span class="op">=</span> <span class="st">"EPA per play (passes, rushes, and penalties)"</span>,
       title <span class="op">=</span> <span class="st">"Quarterback Efficiency, 2015 - 2019"</span>,
       caption <span class="op">=</span> <span class="st">"Data: @nflfastR"</span><span class="op">)</span> <span class="op">+</span>
  <span class="co">#uses the black and white ggplot theme</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="co">#center title with hjust = 0.5</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>
    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span>, hjust <span class="op">=</span> <span class="fl">0.5</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="co">#make ticks look nice</span>
  <span class="co">#if this doesn't work, `install.packages('scales')`</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html" class="external-link">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html" class="external-link">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="beginners_guide_files/figure-html/fig2-1.png" width="100%"></p>
<p>This looks complicated, but is just a way of getting a bunch of different stuff on the same plot: we have lines for averages, dots, names, etc. I added comments above to explain what is going on, but in practice for making figures I usually just copy and paste stuff and/or google what I need.</p>
</div>
<div class="section level3">
<h3 id="with-team-logos">With team logos<a class="anchor" aria-label="anchor" href="#with-team-logos"></a>
</h3>
<p>We could also make the same plot with team logos:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">qbs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cpoe</span>, y <span class="op">=</span> <span class="va">epa</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="co">#horizontal line with mean EPA</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">qbs</span><span class="op">$</span><span class="va">epa</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="co">#vertical line with mean CPOE</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">qbs</span><span class="op">$</span><span class="va">cpoe</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="co">#add points for the QBs with the logos</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggimage/man/geom_image.html" class="external-link">geom_image</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>image <span class="op">=</span> <span class="va">team_logo_espn</span><span class="op">)</span>, size <span class="op">=</span> <span class="va">qbs</span><span class="op">$</span><span class="va">n_plays</span> <span class="op">/</span> <span class="fl">45000</span>, asp <span class="op">=</span> <span class="fl">16</span> <span class="op">/</span> <span class="fl">9</span><span class="op">)</span> <span class="op">+</span>
  <span class="co">#add names using ggrepel, which tries to make them not overlap</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html" class="external-link">geom_text_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="co">#add a smooth line fitting cpoe + epa</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">stat_smooth</a></span><span class="op">(</span>geom<span class="op">=</span><span class="st">'line'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, se<span class="op">=</span><span class="cn">FALSE</span>, method<span class="op">=</span><span class="st">'lm'</span><span class="op">)</span><span class="op">+</span>
  <span class="co">#titles and caption</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Completion % above expected (CPOE)"</span>,
       y <span class="op">=</span> <span class="st">"EPA per play (passes, rushes, and penalties)"</span>,
       title <span class="op">=</span> <span class="st">"Quarterback Efficiency, 2015 - 2019"</span>,
       caption <span class="op">=</span> <span class="st">"Data: @nflfastR"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="co">#center title</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>
    aspect.ratio <span class="op">=</span> <span class="fl">9</span> <span class="op">/</span> <span class="fl">16</span>,
    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span>, hjust <span class="op">=</span> <span class="fl">0.5</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="co">#make ticks look nice</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html" class="external-link">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html" class="external-link">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="beginners_guide_files/figure-html/fig3-1.png" width="100%"></p>
<p>The only changes we’ve made are to use <code>geom_image</code> instead of <code>geom_point</code>, and to put <code>aspect.ratio = 9 / 16</code> in the <code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme()</a></code> part. This makes the plot output dimensions consistent with the provided images and leads to the images not looking squished (how to figure out the right size for the images? Trial and error).</p>
<p>This figure would look better with transparent logos or fewer players shown, but the point of this is explaining how to do stuff, so let’s call this good enough.</p>
</div>
</div>
<div class="section level2">
<h2 id="real-life-example-lets-make-a-win-total-model">Real life example: let’s make a win total model<a class="anchor" aria-label="anchor" href="#real-life-example-lets-make-a-win-total-model"></a>
</h2>
<p>I’m going to try to go through the process of cleaning and joining multiple data sets to try to get a sense of how I would approach something like this, step-by-step.</p>
<div class="section level3">
<h3 id="get-team-wins-each-season">Get team wins each season<a class="anchor" aria-label="anchor" href="#get-team-wins-each-season"></a>
</h3>
<p>We’re going to cheat a little and take advantage of Lee Sharpe’s famous <code>games</code> file. Most of this stuff has been added into <code>nflfastR</code>, but it’s easier working with this file where each game is one row. If you’re curious, the triple colon is a way to access what is referred to as non-exported functions in a package. Think of this as like a secret menu (why is this secret? Sometimes package developers want to limit the number of exported functions as to be not overwhelming).</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">games</span> <span class="op">&lt;-</span> <span class="fu">nflreadr</span><span class="fu">::</span><span class="fu"><a href="https://nflreadr.nflverse.com/reference/load_schedules.html" class="external-link">load_schedules</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">games</span><span class="op">)</span>
<span class="co">#&gt; nflverse_data [6,409 × 45] (S3: nflverse_data/tbl_df/tbl/data.table/data.frame)</span>
<span class="co">#&gt;  $ game_id         : chr [1:6409] "1999_01_MIN_ATL" "1999_01_KC_CHI" "1999_01_PIT_CLE" "1999_01_OAK_GB" ...</span>
<span class="co">#&gt;  $ season          : int [1:6409] 1999 1999 1999 1999 1999 1999 1999 1999 1999 1999 ...</span>
<span class="co">#&gt;  $ game_type       : chr [1:6409] "REG" "REG" "REG" "REG" ...</span>
<span class="co">#&gt;  $ week            : int [1:6409] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ gameday         : chr [1:6409] "1999-09-12" "1999-09-12" "1999-09-12" "1999-09-12" ...</span>
<span class="co">#&gt;  $ weekday         : chr [1:6409] "Sunday" "Sunday" "Sunday" "Sunday" ...</span>
<span class="co">#&gt;  $ gametime        : chr [1:6409] NA NA NA NA ...</span>
<span class="co">#&gt;  $ away_team       : chr [1:6409] "MIN" "KC" "PIT" "OAK" ...</span>
<span class="co">#&gt;  $ away_score      : int [1:6409] 17 17 43 24 14 3 10 30 25 28 ...</span>
<span class="co">#&gt;  $ home_team       : chr [1:6409] "ATL" "CHI" "CLE" "GB" ...</span>
<span class="co">#&gt;  $ home_score      : int [1:6409] 14 20 0 28 31 41 19 28 24 20 ...</span>
<span class="co">#&gt;  $ location        : chr [1:6409] "Home" "Home" "Home" "Home" ...</span>
<span class="co">#&gt;  $ result          : int [1:6409] -3 3 -43 4 17 38 9 -2 -1 -8 ...</span>
<span class="co">#&gt;  $ total           : int [1:6409] 31 37 43 52 45 44 29 58 49 48 ...</span>
<span class="co">#&gt;  $ overtime        : int [1:6409] 0 0 0 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ old_game_id     : chr [1:6409] "1999091210" "1999091206" "1999091213" "1999091208" ...</span>
<span class="co">#&gt;  $ gsis            : int [1:6409] 598 597 604 602 591 603 592 600 588 596 ...</span>
<span class="co">#&gt;  $ nfl_detail_id   : chr [1:6409] NA NA NA NA ...</span>
<span class="co">#&gt;  $ pfr             : chr [1:6409] "199909120atl" "199909120chi" "199909120cle" "199909120gnb" ...</span>
<span class="co">#&gt;  $ pff             : int [1:6409] NA NA NA NA NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ espn            : chr [1:6409] "190912001" "190912003" "190912005" "190912009" ...</span>
<span class="co">#&gt;  $ away_rest       : int [1:6409] 7 7 7 7 7 7 7 7 7 7 ...</span>
<span class="co">#&gt;  $ home_rest       : int [1:6409] 7 7 7 7 7 7 7 7 7 7 ...</span>
<span class="co">#&gt;  $ away_moneyline  : int [1:6409] NA NA NA NA NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ home_moneyline  : int [1:6409] NA NA NA NA NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ spread_line     : num [1:6409] -4 -3 -6 9 -3 5.5 3.5 7 -3 9.5 ...</span>
<span class="co">#&gt;  $ away_spread_odds: int [1:6409] NA NA NA NA NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ home_spread_odds: int [1:6409] NA NA NA NA NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ total_line      : num [1:6409] 49 38 37 43 45.5 49 38 44.5 37 42 ...</span>
<span class="co">#&gt;  $ under_odds      : int [1:6409] NA NA NA NA NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ over_odds       : int [1:6409] NA NA NA NA NA NA NA NA NA NA ...</span>
<span class="co">#&gt;  $ div_game        : int [1:6409] 0 0 1 0 1 0 1 1 1 0 ...</span>
<span class="co">#&gt;  $ roof            : chr [1:6409] "dome" "outdoors" "outdoors" "outdoors" ...</span>
<span class="co">#&gt;  $ surface         : chr [1:6409] "astroturf" "grass" "grass" "grass" ...</span>
<span class="co">#&gt;  $ temp            : int [1:6409] NA 80 78 67 NA 76 NA 73 75 NA ...</span>
<span class="co">#&gt;  $ wind            : int [1:6409] NA 12 12 10 NA 8 NA 5 3 NA ...</span>
<span class="co">#&gt;  $ away_qb_id      : chr [1:6409] "00-0003761" "00-0006300" "00-0015700" "00-0005741" ...</span>
<span class="co">#&gt;  $ home_qb_id      : chr [1:6409] "00-0002876" "00-0010560" "00-0004230" "00-0005106" ...</span>
<span class="co">#&gt;  $ away_qb_name    : chr [1:6409] "Randall Cunningham" "Elvis Grbac" "Kordell Stewart" "Rich Gannon" ...</span>
<span class="co">#&gt;  $ home_qb_name    : chr [1:6409] "Chris Chandler" "Shane Matthews" "Ty Detmer" "Brett Favre" ...</span>
<span class="co">#&gt;  $ away_coach      : chr [1:6409] "Dennis Green" "Gunther Cunningham" "Bill Cowher" "Jon Gruden" ...</span>
<span class="co">#&gt;  $ home_coach      : chr [1:6409] "Dan Reeves" "Dick Jauron" "Chris Palmer" "Ray Rhodes" ...</span>
<span class="co">#&gt;  $ referee         : chr [1:6409] "Gerry Austin" "Phil Luckett" "Bob McElwee" "Tony Corrente" ...</span>
<span class="co">#&gt;  $ stadium_id      : chr [1:6409] "ATL00" "CHI98" "CLE00" "GNB00" ...</span>
<span class="co">#&gt;  $ stadium         : chr [1:6409] "Georgia Dome" "Soldier Field" "Cleveland Browns Stadium" "Lambeau Field" ...</span>
<span class="co">#&gt;  - attr(*, "nflverse_type")= chr "games and schedules"</span></code></pre></div>
<p>To start, we want to create a dataframe where each row is a team-season observation, listing how many games they won. There are multiple ways to do this, but I’m going to just take the home and away results and bind together. As an example, here’s what the <code>home</code> results look like:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">home</span> <span class="op">&lt;-</span> <span class="va">games</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">game_type</span> <span class="op">==</span> <span class="st">'REG'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">season</span>, <span class="va">week</span>, <span class="va">home_team</span>, <span class="va">result</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>team <span class="op">=</span> <span class="va">home_team</span><span class="op">)</span>
<span class="va">home</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>
<span class="co">#&gt; ── <span style="font-style: italic;">nflverse games and schedules</span> ────────────────────────────────────────────────</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 4</span></span>
<span class="co">#&gt;   season  week team  result</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>   <span style="text-decoration: underline;">1</span>999     1 ATL       -<span style="color: #BB0000;">3</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>   <span style="text-decoration: underline;">1</span>999     1 CHI        3</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>   <span style="text-decoration: underline;">1</span>999     1 CLE      -<span style="color: #BB0000;">43</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span>   <span style="text-decoration: underline;">1</span>999     1 GB         4</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span>   <span style="text-decoration: underline;">1</span>999     1 IND       17</span></code></pre></div>
<p>Note that we used <code>rename</code> to change <code>home_team</code> to <code>team</code>.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">away</span> <span class="op">&lt;-</span> <span class="va">games</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">game_type</span> <span class="op">==</span> <span class="st">'REG'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">season</span>, <span class="va">week</span>, <span class="va">away_team</span>, <span class="va">result</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>team <span class="op">=</span> <span class="va">away_team</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>result <span class="op">=</span> <span class="op">-</span><span class="va">result</span><span class="op">)</span>
<span class="va">away</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>
<span class="co">#&gt; ── <span style="font-style: italic;">nflverse games and schedules</span> ────────────────────────────────────────────────</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 4</span></span>
<span class="co">#&gt;   season  week team  result</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>   <span style="text-decoration: underline;">1</span>999     1 MIN        3</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>   <span style="text-decoration: underline;">1</span>999     1 KC        -<span style="color: #BB0000;">3</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>   <span style="text-decoration: underline;">1</span>999     1 PIT       43</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span>   <span style="text-decoration: underline;">1</span>999     1 OAK       -<span style="color: #BB0000;">4</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span>   <span style="text-decoration: underline;">1</span>999     1 BUF      -<span style="color: #BB0000;">17</span></span></code></pre></div>
<p>For away teams, we need to flip the result since result is given from the perspective of the home team. Now let’s make a columns called <code>win</code> based on the result.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">home</span>, <span class="va">away</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">week</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>
    win <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span>
      <span class="va">result</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">~</span> <span class="fl">1</span>,
      <span class="va">result</span> <span class="op">&lt;</span> <span class="fl">0</span> <span class="op">~</span> <span class="fl">0</span>,
      <span class="va">result</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">~</span> <span class="fl">0.5</span>
    <span class="op">)</span>
  <span class="op">)</span>

<span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">season</span> <span class="op">==</span> <span class="fl">2019</span> <span class="op">&amp;</span> <span class="va">team</span> <span class="op">==</span> <span class="st">'SEA'</span><span class="op">)</span>
<span class="co">#&gt; ── <span style="font-style: italic;">nflverse games and schedules</span> ────────────────────────────────────────────────</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 16 × 5</span></span>
<span class="co">#&gt;    season  week team  result   win</span>
<span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>   <span style="text-decoration: underline;">2</span>019     1 SEA        1     1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   <span style="text-decoration: underline;">2</span>019     2 SEA        2     1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>   <span style="text-decoration: underline;">2</span>019     3 SEA       -<span style="color: #BB0000;">6</span>     0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   <span style="text-decoration: underline;">2</span>019     4 SEA       17     1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>   <span style="text-decoration: underline;">2</span>019     5 SEA        1     1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>   <span style="text-decoration: underline;">2</span>019     6 SEA        4     1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>   <span style="text-decoration: underline;">2</span>019     7 SEA      -<span style="color: #BB0000;">14</span>     0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>   <span style="text-decoration: underline;">2</span>019     8 SEA        7     1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>   <span style="text-decoration: underline;">2</span>019     9 SEA        6     1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span>   <span style="text-decoration: underline;">2</span>019    10 SEA        3     1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">11</span>   <span style="text-decoration: underline;">2</span>019    12 SEA        8     1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">12</span>   <span style="text-decoration: underline;">2</span>019    13 SEA        7     1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">13</span>   <span style="text-decoration: underline;">2</span>019    14 SEA      -<span style="color: #BB0000;">16</span>     0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">14</span>   <span style="text-decoration: underline;">2</span>019    15 SEA        6     1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">15</span>   <span style="text-decoration: underline;">2</span>019    16 SEA      -<span style="color: #BB0000;">14</span>     0</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">16</span>   <span style="text-decoration: underline;">2</span>019    17 SEA       -<span style="color: #BB0000;">5</span>     0</span></code></pre></div>
<p>Doing the <code>results %&gt;% filter(season == 2019 &amp; team == 'SEA')</code> part at the end isn’t actually for saving the data in a new form, but just making sure the previous step did what I wanted. This is a good habit to get into: frequently inspect your data and make sure it looks like you think it should.</p>
<p>Now that we have the dataframe we wanted, we can get team wins by season easily:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">team_wins</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">team</span>, <span class="va">season</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>
    wins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">win</span><span class="op">)</span>,
    point_diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; `summarise()` has grouped output by 'team'. You can override using the</span>
<span class="co">#&gt; `.groups` argument.</span>

<span class="va">team_wins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">wins</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 4</span></span>
<span class="co">#&gt;   team  season  wins point_diff</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> NE      <span style="text-decoration: underline;">2</span>007    16        315</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> CAR     <span style="text-decoration: underline;">2</span>015    15        192</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> GB      <span style="text-decoration: underline;">2</span>011    15        201</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> PIT     <span style="text-decoration: underline;">2</span>004    15        121</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> BAL     <span style="text-decoration: underline;">2</span>019    14        249</span></code></pre></div>
<p>Again, we’re making sure the data looks like it “should” by checking the 5 seasons with the most wins, and making sure it looks right.</p>
<p>Now that the team-season win and point differential data is ready, we need to go back to the <code>nflfastR</code> data to get EPA/play.</p>
</div>
<div class="section level3">
<h3 id="get-team-epa-by-season">Get team EPA by season<a class="anchor" aria-label="anchor" href="#get-team-epa-by-season"></a>
</h3>
<p>Let’s start by getting data from every season from the <code>nflfastR</code> data repository:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_pbp.html">load_pbp</a></span><span class="op">(</span><span class="fl">1999</span><span class="op">:</span><span class="fl">2019</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">rush</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">pass</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">season_type</span> <span class="op">==</span> <span class="st">"REG"</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">epa</span><span class="op">)</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">posteam</span><span class="op">)</span>, <span class="va">posteam</span> <span class="op">!=</span> <span class="st">""</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">season</span>, <span class="va">posteam</span>, <span class="va">pass</span>, <span class="va">defteam</span>, <span class="va">epa</span><span class="op">)</span></code></pre></div>
<p>I’m being pretty aggressive with dropping rows and columns (<code>filter</code> and <code>select</code>) because otherwise loading this all into memory can be painful on the computer. But this is all we need for what we’re doing. Note that I’m only keeping regular season games here (<code>season_type == "REG"</code>) since this is how this analysis is usually done.</p>
<p>Now we can get EPA/play on offense and defense. Let’s break it out by pass and rush too. I don’t remember how to do some of this so let’s do it in steps. We know we need to group by team, season, and pass, so there’s the beginning:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">posteam</span>, <span class="va">season</span>, <span class="va">pass</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>epa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">epa</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>
<span class="co">#&gt; `summarise()` has grouped output by 'posteam', 'season'. You can override using</span>
<span class="co">#&gt; the `.groups` argument.</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 4</span></span>
<span class="co">#&gt; <span style="color: #949494;"># Groups:   posteam, season [2]</span></span>
<span class="co">#&gt;   posteam season  pass     epa</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> ARI       <span style="text-decoration: underline;">1</span>999     0 -<span style="color: #BB0000;">0.201</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> ARI       <span style="text-decoration: underline;">1</span>999     1 -<span style="color: #BB0000;">0.162</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> ARI       <span style="text-decoration: underline;">2</span>000     0 -<span style="color: #BB0000;">0.240</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> ARI       <span style="text-decoration: underline;">2</span>000     1 -<span style="color: #BB0000;">0.071</span><span style="color: #BB0000; text-decoration: underline;">8</span></span></code></pre></div>
<p>But this makes two rows per team-season. How to get each team-season on the same row? <code>pivot_wider</code> is what we need:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pbp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">posteam</span>, <span class="va">season</span>, <span class="va">pass</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>epa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">epa</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">pass</span>, values_from <span class="op">=</span> <span class="va">epa</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>
<span class="co">#&gt; `summarise()` has grouped output by 'posteam', 'season'. You can override using</span>
<span class="co">#&gt; the `.groups` argument.</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 4</span></span>
<span class="co">#&gt; <span style="color: #949494;"># Groups:   posteam, season [4]</span></span>
<span class="co">#&gt;   posteam season    `0`     `1`</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> ARI       <span style="text-decoration: underline;">1</span>999 -<span style="color: #BB0000;">0.201</span> -<span style="color: #BB0000;">0.162</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> ARI       <span style="text-decoration: underline;">2</span>000 -<span style="color: #BB0000;">0.240</span> -<span style="color: #BB0000;">0.071</span><span style="color: #BB0000; text-decoration: underline;">8</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> ARI       <span style="text-decoration: underline;">2</span>001 -<span style="color: #BB0000;">0.177</span>  0.074<span style="text-decoration: underline;">0</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> ARI       <span style="text-decoration: underline;">2</span>002 -<span style="color: #BB0000;">0.134</span> -<span style="color: #BB0000;">0.066</span><span style="color: #BB0000; text-decoration: underline;">1</span></span></code></pre></div>
<p>This one is hard to wrap my head around so I usually open up the <a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">reference page</a>, read the example, and pray that what I try works. In this case it did. Hooray! This turned our two-lines-per-team dataframe into one, with the 0 column being pass == 0 (run plays) and the 1 column pass == 1.</p>
<p>Now let’s rename to something more sensible and save:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">offense</span> <span class="op">&lt;-</span> <span class="va">pbp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">posteam</span>, <span class="va">season</span>, <span class="va">pass</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>epa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">epa</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">pass</span>, values_from <span class="op">=</span> <span class="va">epa</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>off_pass_epa <span class="op">=</span> <span class="va">`1`</span>, off_rush_epa <span class="op">=</span> <span class="va">`0`</span><span class="op">)</span>
<span class="co">#&gt; `summarise()` has grouped output by 'posteam', 'season'. You can override using</span>
<span class="co">#&gt; the `.groups` argument.</span></code></pre></div>
<p>Note that variable names that are numbers need to be surrounded in tick marks for this to work.</p>
<p>Now we can repeat the same process for defense:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">defense</span> <span class="op">&lt;-</span> <span class="va">pbp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">defteam</span>, <span class="va">season</span>, <span class="va">pass</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>epa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">epa</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">pass</span>, values_from <span class="op">=</span> <span class="va">epa</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>def_pass_epa <span class="op">=</span> <span class="va">`1`</span>, def_rush_epa <span class="op">=</span> <span class="va">`0`</span><span class="op">)</span>
<span class="co">#&gt; `summarise()` has grouped output by 'defteam', 'season'. You can override using</span>
<span class="co">#&gt; the `.groups` argument.</span></code></pre></div>
<p>Let’s do another sanity check looking at the top 5 pass offenses and defenses:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#top 5 offenses</span>
<span class="va">offense</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">off_pass_epa</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 4</span></span>
<span class="co">#&gt; <span style="color: #949494;"># Groups:   posteam, season [5]</span></span>
<span class="co">#&gt;   posteam season off_rush_epa off_pass_epa</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> NE        <span style="text-decoration: underline;">2</span>007      0.003<span style="text-decoration: underline;">80</span>        0.422</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> IND       <span style="text-decoration: underline;">2</span>004     -<span style="color: #BB0000;">0.001</span><span style="color: #BB0000; text-decoration: underline;">25</span>        0.413</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> GB        <span style="text-decoration: underline;">2</span>011     -<span style="color: #BB0000;">0.114</span>          0.412</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> KC        <span style="text-decoration: underline;">2</span>018      0.020<span style="text-decoration: underline;">9</span>         0.348</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> DEN       <span style="text-decoration: underline;">2</span>013     -<span style="color: #BB0000;">0.029</span><span style="color: #BB0000; text-decoration: underline;">6</span>         0.343</span>

<span class="co">#top 5 defenses</span>
<span class="va">defense</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">def_pass_epa</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 4</span></span>
<span class="co">#&gt; <span style="color: #949494;"># Groups:   defteam, season [5]</span></span>
<span class="co">#&gt;   defteam season def_rush_epa def_pass_epa</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> TB        <span style="text-decoration: underline;">2</span>002      -<span style="color: #BB0000;">0.075</span><span style="color: #BB0000; text-decoration: underline;">6</span>       -<span style="color: #BB0000;">0.292</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> NE        <span style="text-decoration: underline;">2</span>019      -<span style="color: #BB0000;">0.168</span>        -<span style="color: #BB0000;">0.241</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> JAX       <span style="text-decoration: underline;">2</span>017      -<span style="color: #BB0000;">0.141</span>        -<span style="color: #BB0000;">0.224</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> NYJ       <span style="text-decoration: underline;">2</span>009      -<span style="color: #BB0000;">0.104</span>        -<span style="color: #BB0000;">0.220</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> LA        <span style="text-decoration: underline;">2</span>003      -<span style="color: #BB0000;">0.054</span><span style="color: #BB0000; text-decoration: underline;">8</span>       -<span style="color: #BB0000;">0.214</span></span></code></pre></div>
<p>The top pass defenses (2002 TB, 2017 JAX, 2019 NE) and offenses (2007 Pats, 2004 Colts, 2011 Packers) definitely check out!</p>
</div>
<div class="section level3">
<h3 id="fix-team-names-and-join">Fix team names and join<a class="anchor" aria-label="anchor" href="#fix-team-names-and-join"></a>
</h3>
<p>Now we’re ready to bind it all together. Actually, let’s make sure all the team names are ready too.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">team_wins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">team</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 35 × 2</span></span>
<span class="co">#&gt;    team      n</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> LV        3</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> LAC       6</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> LA        7</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> STL      17</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> SD       18</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> HOU      21</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> OAK      21</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> ARI      24</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> ATL      24</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> BAL      24</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 25 more rows</span></span></code></pre></div>
<p>Nope, not yet, we need to fix the Raiders, Rams, and Chargers, which are LV, LA, and LAC in <code>nflfastR</code>.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">team_wins</span> <span class="op">&lt;-</span> <span class="va">team_wins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>
    team <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span>
      <span class="va">team</span> <span class="op">==</span> <span class="st">'OAK'</span> <span class="op">~</span> <span class="st">'LV'</span>,
      <span class="va">team</span> <span class="op">==</span> <span class="st">'SD'</span> <span class="op">~</span> <span class="st">'LAC'</span>,
      <span class="va">team</span> <span class="op">==</span> <span class="st">'STL'</span> <span class="op">~</span> <span class="st">'LA'</span>,
      <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">team</span>
    <span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p>The <code>TRUE</code> statement at the bottom says that if none of the above cases are found, keep team the same. Let’s make sure this worked:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">team_wins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">team</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 32 × 2</span></span>
<span class="co">#&gt;    team      n</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> HOU      21</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> ARI      24</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> ATL      24</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> BAL      24</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> BUF      24</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> CAR      24</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> CHI      24</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> CIN      24</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> CLE      24</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> DAL      24</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 22 more rows</span></span></code></pre></div>
<p>HOU has 3 fewer seasons because it didn’t exist from 1999 through 2001, which is fine, and all the other team names have 22 seasons like they should. Okay NOW we can join:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">team_wins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">offense</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'team'</span> <span class="op">=</span> <span class="st">'posteam'</span>, <span class="st">'season'</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">defense</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'team'</span> <span class="op">=</span> <span class="st">'defteam'</span>, <span class="st">'season'</span><span class="op">)</span><span class="op">)</span>

<span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">team</span> <span class="op">==</span> <span class="st">'SEA'</span> <span class="op">&amp;</span> <span class="va">season</span> <span class="op">&gt;=</span> <span class="fl">2012</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 8</span></span>
<span class="co">#&gt;    team  season  wins point_diff off_rush_epa off_pass_epa def_rush_epa</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> SEA     <span style="text-decoration: underline;">2</span>012  11          167     -<span style="color: #BB0000;">0.004</span><span style="color: #BB0000; text-decoration: underline;">76</span>       0.213       -<span style="color: #BB0000;">0.073</span><span style="color: #BB0000; text-decoration: underline;">8</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> SEA     <span style="text-decoration: underline;">2</span>013  13          186     -<span style="color: #BB0000;">0.101</span>         0.188       -<span style="color: #BB0000;">0.126</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> SEA     <span style="text-decoration: underline;">2</span>014  12          140      0.021<span style="text-decoration: underline;">6</span>        0.139       -<span style="color: #BB0000;">0.231</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> SEA     <span style="text-decoration: underline;">2</span>015  10          146     -<span style="color: #BB0000;">0.105</span>         0.249       -<span style="color: #BB0000;">0.148</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> SEA     <span style="text-decoration: underline;">2</span>016  10.5         62     -<span style="color: #BB0000;">0.126</span>         0.102       -<span style="color: #BB0000;">0.207</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> SEA     <span style="text-decoration: underline;">2</span>017   9           34     -<span style="color: #BB0000;">0.192</span>         0.058<span style="text-decoration: underline;">4</span>      -<span style="color: #BB0000;">0.122</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> SEA     <span style="text-decoration: underline;">2</span>018  10           81     -<span style="color: #BB0000;">0.027</span><span style="color: #BB0000; text-decoration: underline;">3</span>        0.209       -<span style="color: #BB0000;">0.131</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> SEA     <span style="text-decoration: underline;">2</span>019  11            7     -<span style="color: #BB0000;">0.136</span>         0.119       -<span style="color: #BB0000;">0.093</span><span style="color: #BB0000; text-decoration: underline;">0</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> SEA     <span style="text-decoration: underline;">2</span>020  12           88     <span style="color: #BB0000;">NA</span>            <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span>     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> SEA     <span style="text-decoration: underline;">2</span>021   7           29     <span style="color: #BB0000;">NA</span>            <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span>     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">11</span> SEA     <span style="text-decoration: underline;">2</span>022  <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>            <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span>     </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 1 more variable: def_pass_epa &lt;dbl&gt;</span></span></code></pre></div>
<p>Now we’re getting really close to doing what we want! Next we need to create new columns for prior year EPA, and let’s do point differential too.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">team</span>, <span class="va">season</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">team</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>
    prior_off_rush_epa <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">off_rush_epa</span><span class="op">)</span>,
    prior_off_pass_epa <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">off_pass_epa</span><span class="op">)</span>,
    prior_def_rush_epa <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">def_rush_epa</span><span class="op">)</span>,
    prior_def_pass_epa <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">def_pass_epa</span><span class="op">)</span>,
    prior_point_diff <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">point_diff</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 13</span></span>
<span class="co">#&gt;   team  season  wins point_diff off_rush_epa off_pass_epa def_rush_epa</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> ARI     <span style="text-decoration: underline;">1</span>999     6       -<span style="color: #BB0000;">137</span>       -<span style="color: #BB0000;">0.201</span>      -<span style="color: #BB0000;">0.162</span>       -<span style="color: #BB0000;">0.010</span><span style="color: #BB0000; text-decoration: underline;">5</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> ARI     <span style="text-decoration: underline;">2</span>000     3       -<span style="color: #BB0000;">233</span>       -<span style="color: #BB0000;">0.240</span>      -<span style="color: #BB0000;">0.071</span><span style="color: #BB0000; text-decoration: underline;">8</span>       0.033<span style="text-decoration: underline;">3</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> ARI     <span style="text-decoration: underline;">2</span>001     7        -<span style="color: #BB0000;">48</span>       -<span style="color: #BB0000;">0.177</span>       0.074<span style="text-decoration: underline;">0</span>      -<span style="color: #BB0000;">0.068</span><span style="color: #BB0000; text-decoration: underline;">9</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> ARI     <span style="text-decoration: underline;">2</span>002     5       -<span style="color: #BB0000;">155</span>       -<span style="color: #BB0000;">0.134</span>      -<span style="color: #BB0000;">0.066</span><span style="color: #BB0000; text-decoration: underline;">1</span>      -<span style="color: #BB0000;">0.019</span><span style="color: #BB0000; text-decoration: underline;">2</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> ARI     <span style="text-decoration: underline;">2</span>003     4       -<span style="color: #BB0000;">227</span>       -<span style="color: #BB0000;">0.219</span>      -<span style="color: #BB0000;">0.120</span>       -<span style="color: #BB0000;">0.062</span><span style="color: #BB0000; text-decoration: underline;">7</span></span>
<span class="co">#&gt; <span style="color: #949494;"># … with 6 more variables: def_pass_epa &lt;dbl&gt;, prior_off_rush_epa &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   prior_off_pass_epa &lt;dbl&gt;, prior_def_rush_epa &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   prior_def_pass_epa &lt;dbl&gt;, prior_point_diff &lt;int&gt;</span></span></code></pre></div>
<p>Finally! Now we have the data in place and can start doing things with it.</p>
</div>
<div class="section level3">
<h3 id="correlations-and-regressions">Correlations and regressions<a class="anchor" aria-label="anchor" href="#correlations-and-regressions"></a>
</h3>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">team</span>, <span class="op">-</span><span class="va">season</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span>use<span class="op">=</span><span class="st">"complete.obs"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt;                     wins point_diff off_rush_epa off_pass_epa def_rush_epa</span>
<span class="co">#&gt; wins                1.00       0.92         0.43         0.70        -0.29</span>
<span class="co">#&gt; point_diff          0.92       1.00         0.49         0.76        -0.33</span>
<span class="co">#&gt; off_rush_epa        0.43       0.49         1.00         0.40         0.05</span>
<span class="co">#&gt; off_pass_epa        0.70       0.76         0.40         1.00        -0.01</span>
<span class="co">#&gt; def_rush_epa       -0.29      -0.33         0.05        -0.01         1.00</span>
<span class="co">#&gt; def_pass_epa       -0.57      -0.62        -0.04        -0.10         0.31</span>
<span class="co">#&gt; prior_off_rush_epa  0.24       0.26         0.32         0.23         0.02</span>
<span class="co">#&gt; prior_off_pass_epa  0.29       0.32         0.18         0.46        -0.01</span>
<span class="co">#&gt; prior_def_rush_epa -0.12      -0.15         0.03        -0.04         0.27</span>
<span class="co">#&gt; prior_def_pass_epa -0.18      -0.20        -0.07        -0.05         0.05</span>
<span class="co">#&gt; prior_point_diff    0.36       0.41         0.22         0.36        -0.09</span>
<span class="co">#&gt;                    def_pass_epa prior_off_rush_epa prior_off_pass_epa</span>
<span class="co">#&gt; wins                      -0.57               0.24               0.29</span>
<span class="co">#&gt; point_diff                -0.62               0.26               0.32</span>
<span class="co">#&gt; off_rush_epa              -0.04               0.32               0.18</span>
<span class="co">#&gt; off_pass_epa              -0.10               0.23               0.46</span>
<span class="co">#&gt; def_rush_epa               0.31               0.02              -0.01</span>
<span class="co">#&gt; def_pass_epa               1.00              -0.10               0.00</span>
<span class="co">#&gt; prior_off_rush_epa        -0.10               1.00               0.41</span>
<span class="co">#&gt; prior_off_pass_epa         0.00               0.41               1.00</span>
<span class="co">#&gt; prior_def_rush_epa         0.16               0.05              -0.01</span>
<span class="co">#&gt; prior_def_pass_epa         0.28              -0.01              -0.09</span>
<span class="co">#&gt; prior_point_diff          -0.19               0.47               0.76</span>
<span class="co">#&gt;                    prior_def_rush_epa prior_def_pass_epa prior_point_diff</span>
<span class="co">#&gt; wins                            -0.12              -0.18             0.36</span>
<span class="co">#&gt; point_diff                      -0.15              -0.20             0.41</span>
<span class="co">#&gt; off_rush_epa                     0.03              -0.07             0.22</span>
<span class="co">#&gt; off_pass_epa                    -0.04              -0.05             0.36</span>
<span class="co">#&gt; def_rush_epa                     0.27               0.05            -0.09</span>
<span class="co">#&gt; def_pass_epa                     0.16               0.28            -0.19</span>
<span class="co">#&gt; prior_off_rush_epa               0.05              -0.01             0.47</span>
<span class="co">#&gt; prior_off_pass_epa              -0.01              -0.09             0.76</span>
<span class="co">#&gt; prior_def_rush_epa               1.00               0.32            -0.34</span>
<span class="co">#&gt; prior_def_pass_epa               0.32               1.00            -0.60</span>
<span class="co">#&gt; prior_point_diff                -0.34              -0.60             1.00</span></code></pre></div>
<p>We’ve covered <code>select</code>, but here we see a new use where a minus sign de-selects variables (we need to de-select team name for correlation to work because it doesn’t work for character strings, and correlation with the season number itself is meaningless). We’ve run the correlation on this dataframe, removing missing values, and then rounding to 2 digits. Not surprisingly, we see that wins in the current season are more strongly related to passing offense EPA than rushing EPA or defense EPA, and prior offense carries more predictive power than prior defense. Pass offense is more stable year to year (<code>0.46</code>) than rush offense (<code>0.32</code>), pass defense (<code>0.28</code>), or rush defense (<code>0.27</code>).</p>
<p>I’m actually surprised that the values for passing offense aren’t higher relative to the others. Maybe it was because most of our prior results come from the <code>nflscrapR</code> era (2009 - 2019)? Let’s check what this looks like since 2009 relative to earlier seasons:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"2009 through 2019"</span><span class="op">)</span>
<span class="co">#&gt; 2009 through 2019</span>
<span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">season</span> <span class="op">&gt;=</span> <span class="fl">2009</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">wins</span>, <span class="va">point_diff</span>, <span class="va">off_pass_epa</span>, <span class="va">off_rush_epa</span>, <span class="va">prior_point_diff</span>, <span class="va">prior_off_pass_epa</span>, <span class="va">prior_off_rush_epa</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span>use<span class="op">=</span><span class="st">"complete.obs"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt;                    wins point_diff off_pass_epa off_rush_epa prior_point_diff</span>
<span class="co">#&gt; wins               1.00       0.92         0.73         0.40             0.43</span>
<span class="co">#&gt; point_diff         0.92       1.00         0.79         0.47             0.44</span>
<span class="co">#&gt; off_pass_epa       0.73       0.79         1.00         0.37             0.39</span>
<span class="co">#&gt; off_rush_epa       0.40       0.47         0.37         1.00             0.19</span>
<span class="co">#&gt; prior_point_diff   0.43       0.44         0.39         0.19             1.00</span>
<span class="co">#&gt; prior_off_pass_epa 0.34       0.36         0.45         0.11             0.78</span>
<span class="co">#&gt; prior_off_rush_epa 0.24       0.25         0.17         0.24             0.46</span>
<span class="co">#&gt;                    prior_off_pass_epa prior_off_rush_epa</span>
<span class="co">#&gt; wins                             0.34               0.24</span>
<span class="co">#&gt; point_diff                       0.36               0.25</span>
<span class="co">#&gt; off_pass_epa                     0.45               0.17</span>
<span class="co">#&gt; off_rush_epa                     0.11               0.24</span>
<span class="co">#&gt; prior_point_diff                 0.78               0.46</span>
<span class="co">#&gt; prior_off_pass_epa               1.00               0.35</span>
<span class="co">#&gt; prior_off_rush_epa               0.35               1.00</span></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"1999 through 2008"</span><span class="op">)</span>
<span class="co">#&gt; 1999 through 2008</span>
<span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">season</span> <span class="op">&lt;</span> <span class="fl">2009</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">wins</span>, <span class="va">point_diff</span>, <span class="va">off_pass_epa</span>, <span class="va">off_rush_epa</span>, <span class="va">prior_point_diff</span>, <span class="va">prior_off_pass_epa</span>, <span class="va">prior_off_rush_epa</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span>use<span class="op">=</span><span class="st">"complete.obs"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt;                    wins point_diff off_pass_epa off_rush_epa prior_point_diff</span>
<span class="co">#&gt; wins               1.00       0.92         0.68         0.48             0.28</span>
<span class="co">#&gt; point_diff         0.92       1.00         0.73         0.51             0.36</span>
<span class="co">#&gt; off_pass_epa       0.68       0.73         1.00         0.47             0.34</span>
<span class="co">#&gt; off_rush_epa       0.48       0.51         0.47         1.00             0.25</span>
<span class="co">#&gt; prior_point_diff   0.28       0.36         0.34         0.25             1.00</span>
<span class="co">#&gt; prior_off_pass_epa 0.23       0.29         0.45         0.30             0.74</span>
<span class="co">#&gt; prior_off_rush_epa 0.23       0.28         0.30         0.40             0.50</span>
<span class="co">#&gt;                    prior_off_pass_epa prior_off_rush_epa</span>
<span class="co">#&gt; wins                             0.23               0.23</span>
<span class="co">#&gt; point_diff                       0.29               0.28</span>
<span class="co">#&gt; off_pass_epa                     0.45               0.30</span>
<span class="co">#&gt; off_rush_epa                     0.30               0.40</span>
<span class="co">#&gt; prior_point_diff                 0.74               0.50</span>
<span class="co">#&gt; prior_off_pass_epa               1.00               0.48</span>
<span class="co">#&gt; prior_off_rush_epa               0.48               1.00</span></code></pre></div>
<p>Yep, that seems to be the case. So in the more recent period, passing offense has become slightly more stable but more predictive of following-year success, while at the same time rushing offense has become substantially less stable and less predictive of future team success.</p>
<p>Now let’s do a basic regression of wins on prior offense and defense EPA/play. Maybe we should only look at this more recent period to fit our model since it’s more relevant for 2020. In the real world, we would be more rigorous about making decisions like this, but let’s proceed anyway.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">season</span> <span class="op">&gt;=</span> <span class="fl">2009</span><span class="op">)</span>

<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">wins</span> <span class="op">~</span> <span class="va">prior_off_pass_epa</span>  <span class="op">+</span> <span class="va">prior_off_rush_epa</span> <span class="op">+</span> <span class="va">prior_def_pass_epa</span> <span class="op">+</span> <span class="va">prior_def_rush_epa</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = wins ~ prior_off_pass_epa + prior_off_rush_epa + </span>
<span class="co">#&gt;     prior_def_pass_epa + prior_def_rush_epa, data = data)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -7.7034 -1.8900  0.0626  2.2490  7.0865 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;                    Estimate Std. Error t value             Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)          7.9661     0.3882  20.518 &lt; 0.0000000000000002 ***</span>
<span class="co">#&gt; prior_off_pass_epa   6.5665     1.2804   5.129          0.000000467 ***</span>
<span class="co">#&gt; prior_off_rush_epa   6.0077     2.2713   2.645              0.00851 ** </span>
<span class="co">#&gt; prior_def_pass_epa  -4.0642     1.6446  -2.471              0.01390 *  </span>
<span class="co">#&gt; prior_def_rush_epa  -5.1617     2.3336  -2.212              0.02757 *  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 2.86 on 379 degrees of freedom</span>
<span class="co">#&gt;   (64 observations deleted due to missingness)</span>
<span class="co">#&gt; Multiple R-squared:  0.1638, Adjusted R-squared:  0.1549 </span>
<span class="co">#&gt; F-statistic: 18.55 on 4 and 379 DF,  p-value: 0.00000000000006141</span></code></pre></div>
<p>I’m actually pretty surprised passing offense isn’t higher here. How does this compare to simply using point differential?</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">wins</span> <span class="op">~</span> <span class="va">prior_point_diff</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = wins ~ prior_point_diff, data = data)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -7.1664 -1.9700  0.1115  2.2317  7.4260 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;                  Estimate Std. Error t value            Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)      8.038462   0.136630  58.834 &lt;0.0000000000000002 ***</span>
<span class="co">#&gt; prior_point_diff 0.013270   0.001345   9.869 &lt;0.0000000000000002 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 2.787 on 414 degrees of freedom</span>
<span class="co">#&gt;   (32 observations deleted due to missingness)</span>
<span class="co">#&gt; Multiple R-squared:  0.1904, Adjusted R-squared:  0.1885 </span>
<span class="co">#&gt; F-statistic: 97.39 on 1 and 414 DF,  p-value: &lt; 0.00000000000000022</span></code></pre></div>
<p>So R2 is somewhat higher for just point differential. This isn’t surprising as we’ve thrown away special teams plays and haven’t attempted to make any adjustments for things like fumble luck that we know can improve EPA’s predictive power.</p>
</div>
<div class="section level3">
<h3 id="predictions">Predictions<a class="anchor" aria-label="anchor" href="#predictions"></a>
</h3>
<p>Now let’s get the predictions from the EPA model:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">preds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">season</span> <span class="op">==</span> <span class="fl">2020</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="co">#was just a vector, need a tibble to bind</span>
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="co">#make the column name make sense</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>prediction <span class="op">=</span> <span class="va">value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="co">#get names</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_cols</a></span><span class="op">(</span>
    <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">season</span> <span class="op">==</span> <span class="fl">2020</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">team</span><span class="op">)</span>
  <span class="op">)</span>

<span class="va">preds</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">prediction</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 2</span></span>
<span class="co">#&gt;   prediction team </span>
<span class="co">#&gt;        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>       11.4 BAL  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>       10.2 SF   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>        9.8 NE   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span>        9.6 DAL  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span>        9.6 NO</span></code></pre></div>
<p>This mostly checks out.</p>
<p>What if we just used simple point differential to predict?</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">preds2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit2</span>, <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">season</span> <span class="op">==</span> <span class="fl">2020</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="co">#was just a vector, need a tibble to bind</span>
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="co">#make the column name make sense</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>prediction <span class="op">=</span> <span class="va">value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="co">#get names</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_cols</a></span><span class="op">(</span>
    <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">season</span> <span class="op">==</span> <span class="fl">2020</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">team</span><span class="op">)</span>
  <span class="op">)</span>

<span class="va">preds2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">prediction</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 2</span></span>
<span class="co">#&gt;   prediction team </span>
<span class="co">#&gt;        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>       11.3 BAL  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>       10.6 NE   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>       10.3 SF   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span>        9.9 KC   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span>        9.6 NO</span></code></pre></div>
<p>Not surprisingly, this looks pretty similar. These are very basic models that don’t incorporate schedule, roster changes, etc. For example, a better model would take into account Tom Brady no longer playing for the Patriots. But hopefully this has been useful!</p>
</div>
</div>
<div class="section level2">
<h2 id="next-steps">Next Steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h2>
<p>You now should know enough to be able to tackle a great deal of questions using <code>nflfastR</code> data. A good way to build up skills is to take interesting things you see and try to replicate them (for making figures, this will also involve a heavy dose of googling stuff).</p>
<p>Looking at others’ code is also a good way to learn. One option is to look through the <code>nflfastR</code> code base, much of which you should now understand what it’s doing. For example, <a href="https://github.com/mrcaseb/nflfastR/blob/master/R/helper_add_nflscrapr_mutations.R" class="external-link">here is the function that cleans up the data and prepares it for later stages</a>: there’s a heavy dose of <code>mutate</code>, <code>group_by</code>, <code>arrange</code>, <code>lag</code>, <code>if_else</code>, and <code>case_when</code>.</p>
<div class="section level3">
<h3 id="resources-the-gold-standards">Resources: The gold standards<a class="anchor" aria-label="anchor" href="#resources-the-gold-standards"></a>
</h3>
<p>This is an R package so this section is pretty R heavy.</p>
<ul>
<li><a href="https://r4ds.had.co.nz/explore-intro.html" class="external-link">Introduction to R (<strong>recommended</strong>)</a></li>
<li>
<a href="https://www.opensourcefootball.com/" class="external-link">Open Source Football</a>: Mix of R and Python</li>
<li>
<a href="https://themockup.blog/" class="external-link">The Mockup Blog (Thomas Mock)</a>: Invaluable resource for making cool stuff in R</li>
</ul>
</div>
<div class="section level3">
<h3 id="code-examples-r">Code examples: R<a class="anchor" aria-label="anchor" href="#code-examples-r"></a>
</h3>
<ul>
<li><a href="https://github.com/leesharpe/nfldata/blob/master/RSTUDIO-INTRO.md" class="external-link">Lee Sharpe: basic intro to R and RStudio</a></li>
<li><a href="https://github.com/leesharpe/nfldata" class="external-link">Lee Sharpe: lots of useful NFL / nflscrapR code</a></li>
<li><a href="https://github.com/leesharpe/nfldata/blob/master/UPDATING-NFLSCRAPR.md" class="external-link">Lee Sharpe: how to update current season games</a></li>
<li><a href="https://t.co/gxDDhOYhcI" class="external-link">Josh Hermsmeyer: Getting Started with R for NFL Analysis</a></li>
<li><a href="https://slavin22.github.io/SFB9-Positional-Tiers/Guide.nb" class="external-link">Slavin: visualizing positional tiers in SFB9</a></li>
<li><a href="https://github.com/ryurko/nflscrapR-data/tree/master/R" class="external-link">Ron Yurko: assorted examples</a></li>
<li><a href="https://github.com/dhouston890/cowboys-stats/blob/master/playmaking_epa_pbp.R" class="external-link">CowboysStats: defensive playmaking EPA</a></li>
<li><a href="https://github.com/statsbylopez/BlogPosts/blob/master/scrapr-data.R" class="external-link">Michael Lopez: function to sample plays</a></li>
<li><a href="https://statsbylopez.netlify.com/post/r-for-nfl-analysis/" class="external-link">Michael Lopez: R for NFL analysis (presentation to club staffers)</a></li>
<li><a href="https://gist.github.com/wessonmo/45781bd25a74e8097e0c8bc8fbacf796" class="external-link">Mitchell Wesson: QB hits investigation</a></li>
<li><a href="https://gist.github.com/wessonmo/ef44ea9873d70f816454cb88b86dcce6" class="external-link">Mitchell Wesson: Investigation of the nflscrapR EP model</a></li>
<li><a href="https://github.com/whoffman21279/Steelers/blob/master/receiving_stats" class="external-link">WHoffman: graphs for receivers (aDoT, success rate, and more)</a></li>
<li><a href="https://gist.github.com/ChiBearsStats/dac3266037797032a23f38fd9d64d6a8#file-adjustedthirddowns-txt" class="external-link">ChiBearsStats: investigation of 3rd downs vs offensive efficiency</a></li>
<li><a href="https://gist.github.com/ChiBearsStats/78e33baeed3cd6d3cac0040b47d4ec69" class="external-link">ChiBearsStats: the insignificance of field goal kicking</a></li>
</ul>
</div>
<div class="section level3">
<h3 id="more-data-sources">More data sources<a class="anchor" aria-label="anchor" href="#more-data-sources"></a>
</h3>
<ul>
<li><a href="https://github.com/leesharpe/nfldata/blob/master/DATASETS.md" class="external-link">Lee Sharpe: Draft Picks, Draft Values, Games, Logos, Rosters, Standings</a></li>
<li><a href="https://github.com/greerre/pfr_metadata_pull" class="external-link">greerre: how to get .csv file of weather &amp; stadium data from PFR in python</a></li>
<li><a href="https://gist.github.com/spfleming/2527a6ca2b940af2a8aa1fee9320171d" class="external-link">Parker Fleming: Introduction to College Football Data with R and cfbscrapR</a></li>
</ul>
</div>
<div class="section level3">
<h3 id="other-code-examples-python">Other code examples: Python<a class="anchor" aria-label="anchor" href="#other-code-examples-python"></a>
</h3>
<ul>
<li><a href="https://gist.github.com/Deryck97/dff8d33e9f841568201a2a0d5519ac5e" class="external-link">Deryck97: nflfastR Python Guide</a></li>
<li><a href="https://colab.research.google.com/github/nickwan/colab_nflfastR/blob/master/nflfastR_starter.ipynb" class="external-link">Nick Wan: nflfastR Python Colab Guide</a></li>
<li><a href="https://github.com/jezlax/sports_analytics/blob/master/animated_nfl_scatter.py" class="external-link">Cory Jez: animated plot</a></li>
<li><a href="https://gist.github.com/903124/6693fdf6b991437a6d6ef9c5d935c83b" class="external-link">903124S: Sampling EP</a></li>
<li><a href="https://gist.github.com/903124/d304f76688b0699497a35b61b6d1e267" class="external-link">903124S: estimating EPA using nfldb</a></li>
<li><a href="https://gist.github.com/903124/3c6f0dc0a100d78b8622573ef4c504f5" class="external-link">903124S: estimate EPA for college football</a></li>
<li>Blake Atkinson: explosiveness <a href="https://medium.com/@BlakeAtkinson/the-2018-kansas-city-chiefs-and-an-explosiveness-metric-in-football-c3b3fd447d73" class="external-link">blog post</a> and <a href="https://github.com/btatkinson/yard_value/blob/master/yard_value.ipynb" class="external-link">python code</a>
</li>
<li>Blake Atkinson: player type visualizations <a href="https://medium.com/@BlakeAtkinson/visualizing-different-nfl-player-styles-88ef31420539" class="external-link">blog post</a> and <a href="https://github.com/btatkinson/player_vectors/blob/master/player_vectors.ipynb" class="external-link">python code</a>
</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://twitter.com/mrcaseb" class="external-link">Sebastian Carl</a>, <a href="https://twitter.com/benbbaldwin" class="external-link">Ben Baldwin</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.9000.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
